/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => StudentRepoPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  stuSettings: {
    grade: "\u5C0F\u5B66\u56DB\u5E74\u7EA7"
  },
  speechSettings: {
    subscriptionKey: "",
    speechLanguage: "en",
    speechVoice: "en-GB-SoniaNeural",
    speechOutputPath: "_audios"
  },
  ocrSettings: {
    appID: "",
    apiKey: "",
    apiSecret: "",
    accessToken: {
      token: "",
      exp: 0
    }
  },
  llmSettings: {
    apiBase: "",
    apiKey: "",
    modelName: ""
  },
  mtSettings: {
    language: "zh-Hans",
    subscriptionKey: ""
  }
};
var StudentRepoSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h1", { text: this.plugin.trans.pluginName });
    new import_obsidian.Setting(containerEl).setName(this.plugin.trans.studentGrade).setDesc(this.plugin.trans.studentGrade).addText((text) => text.setPlaceholder("\u5C0F\u5B66\u56DB\u5E74\u7EA7").setValue(this.plugin.settings.stuSettings.grade).onChange(async (value) => {
      this.plugin.settings.stuSettings.grade = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h2", { text: this.plugin.trans.llmSetting });
    new import_obsidian.Setting(containerEl).setName("API URL").setDesc(`${this.plugin.trans.llmProvider} LLM API URL`).addText((text) => text.setPlaceholder("https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions").setValue(this.plugin.settings.llmSettings.apiBase).onChange(async (value) => {
      this.plugin.settings.llmSettings.apiBase = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Key").setDesc(`${this.plugin.trans.llmProvider} LLM API Key`).addText((text) => text.setPlaceholder("sk-***").setValue(this.plugin.settings.llmSettings.apiKey).onChange(async (value) => {
      this.plugin.settings.llmSettings.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Model Name").setDesc(`${this.plugin.trans.llmProvider} LLM Model Name`).addText((text) => text.setPlaceholder("qwen-turbo").setValue(this.plugin.settings.llmSettings.modelName).onChange(async (value) => {
      this.plugin.settings.llmSettings.modelName = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h2", { text: this.plugin.trans.imageToText });
    new import_obsidian.Setting(containerEl).setName("APP ID").setDesc(`${this.plugin.trans.ocrProvider} APP ID`).addText((text) => text.setPlaceholder("\u4F60\u7533\u8BF7\u5230\u7684APP ID").setValue(this.plugin.settings.ocrSettings.appID).onChange(async (value) => {
      this.plugin.settings.ocrSettings.appID = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Key").setDesc(`${this.plugin.trans.ocrProvider} API Key`).addText((text) => text.setPlaceholder("\u4F60\u7533\u8BF7\u5230\u7684API Key").setValue(this.plugin.settings.ocrSettings.apiKey).onChange(async (value) => {
      this.plugin.settings.ocrSettings.apiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("API Secret").setDesc(`${this.plugin.trans.ocrProvider} API Secret`).addText((text) => text.setPlaceholder("\u4F60\u7533\u8BF7\u5230\u7684API Secret").setValue(this.plugin.settings.ocrSettings.apiSecret).onChange(async (value) => {
      this.plugin.settings.ocrSettings.apiSecret = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h2", { text: this.plugin.trans.speechSetting });
    new import_obsidian.Setting(containerEl).setName(this.plugin.trans.speechSubscriptionKey).setDesc("Microsoft Azure Speech Subscription Key").addText((text) => text.setPlaceholder("Your Azure Speech Subscription Key").setValue(this.plugin.settings.speechSettings.subscriptionKey).onChange(async (value) => {
      this.plugin.settings.speechSettings.subscriptionKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName(this.plugin.trans.speechVoiceType).setDesc("Speech Voice Type").addDropdown((dropdown) => {
      dropdown.addOption("en-GB-SoniaNeural", this.plugin.trans.speechVoiceGB);
      dropdown.addOption("en-US-AmandaMultilingualNeural", this.plugin.trans.speechVoiceUS);
      dropdown.setValue(this.plugin.settings.speechSettings.speechVoice);
      dropdown.onChange((option) => {
        this.plugin.settings.speechSettings.speechVoice = option;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName(this.plugin.trans.mtSubscriptionKey).setDesc("Microsoft Azure Translator Subscription Key").addText((text) => text.setPlaceholder("Your Azure Translator Subscription Key").setValue(this.plugin.settings.mtSettings.subscriptionKey).onChange(async (value) => {
      this.plugin.settings.mtSettings.subscriptionKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("\u7FFB\u8BD1\u8BED\u8A00").setDesc("\u7FFB\u8BD1\u7684\u76EE\u6807\u8BED\u8A00").addDropdown((dropdown) => {
      dropdown.addOption("en", "English");
      dropdown.addOption("zh-Hans", "\u666E\u901A\u8BDD");
      dropdown.setValue(this.plugin.settings.mtSettings.language);
      dropdown.onChange((option) => {
        this.plugin.settings.mtSettings.language = option;
        this.plugin.saveSettings();
      });
    });
  }
};

// src/ms_azure.ts
var import_obsidian2 = require("obsidian");
var serviceRegion = "eastasia";
var speechApiUrl = `https://${serviceRegion}.tts.speech.microsoft.com/cognitiveservices/v1`;
var mtEndpoint = "https://api.cognitive.microsofttranslator.com/";
var visionApiUrl = `https://${serviceRegion}.api.cognitive.microsoft.com/vision/v3.2/ocr`;
async function textToSpeechHttp(text, subscriptionKey, speechVoice) {
  const headers = {
    "Ocp-Apim-Subscription-Key": subscriptionKey,
    "Content-Type": "application/ssml+xml",
    "X-Microsoft-OutputFormat": "audio-16khz-32kbitrate-mono-mp3",
    "User-Agent": "MySDK/1.0"
  };
  const body = `
  <speak version='1.0' xml:lang='en-US'>
      <voice xml:lang='en-US' xml:gender='Female' name='${speechVoice}'>
          ${text}
      </voice>
  </speak>
  `;
  const requestParam = {
    url: speechApiUrl,
    method: "POST",
    headers,
    body
  };
  const response = await (0, import_obsidian2.requestUrl)(requestParam);
  if (response.status != 200) {
    console.error("Text to speech error", response);
    return new ArrayBuffer(0);
  }
  return response.arrayBuffer;
}
async function translateText(text, targetLanguage, subscriptionKey) {
  try {
    const apiUrl = `${mtEndpoint}/translate?api-version=3.0&to=${targetLanguage}`;
    const headers = {
      "Ocp-Apim-Subscription-Key": subscriptionKey,
      "Ocp-Apim-Subscription-Region": serviceRegion,
      "Content-Type": "application/json"
    };
    const body = [
      {
        "text": text
      }
    ];
    const requestParam = {
      url: apiUrl,
      method: "POST",
      headers,
      body: JSON.stringify(body)
    };
    const response = await (0, import_obsidian2.requestUrl)(requestParam);
    if (response.status != 200) {
      console.error("Send llm request error", response);
      return "";
    }
    const result = response.json;
    if (result.length > 0) {
      return result[0].translations[0].text;
    } else {
      throw new Error("\u672A\u83B7\u53D6\u5230\u6709\u6548\u7684\u7FFB\u8BD1\u7ED3\u679C");
    }
  } catch (error) {
    console.error("\u7FFB\u8BD1\u51FA\u9519:", error);
    throw error;
  }
}

// src/baidu_ai.ts
var import_obsidian3 = require("obsidian");
async function createToken(apiKey, apiSecret) {
  if (!apiKey || !apiSecret)
    throw new Error("Invalid API key secret");
  const url = `https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&client_id=${apiKey}&client_secret=${apiSecret}`;
  const headers = {
    "Content-Type": "application/json",
    "Accept": "application/json"
  };
  const response = await (0, import_obsidian3.requestUrl)({
    url,
    method: "POST",
    headers
  });
  if (response.status != 200) {
    console.error("create token error", response);
    return {};
  }
  const data = response.json;
  const token = data.access_token;
  const now = Date.now();
  const exp = now + data.expires_in;
  return {
    token,
    exp
  };
}
async function checkAccessToken(ocrSettings) {
  const now = Date.now();
  if (ocrSettings.accessToken && ocrSettings.accessToken.token && ocrSettings.accessToken.exp > now + 3 * 60 * 1e3) {
    return false;
  }
  const newToken = await createToken(ocrSettings.apiKey, ocrSettings.apiSecret);
  console.log("create new token", newToken);
  ocrSettings.accessToken = newToken;
  return true;
}
async function imageToTextHttp(imageBuffer, ocrSettings) {
  const url = `https://aip.baidubce.com/rest/2.0/ocr/v1/accurate_basic?access_token=${ocrSettings.accessToken.token}`;
  const headers = {
    "Content-Type": "application/x-www-form-urlencoded"
  };
  const image_base64 = (0, import_obsidian3.arrayBufferToBase64)(imageBuffer);
  const body = `image=${encodeURIComponent(image_base64)}&paragraph=true`;
  const requestParam = {
    url,
    method: "POST",
    headers,
    body
  };
  const response = await (0, import_obsidian3.requestUrl)(requestParam);
  if (response.status != 200) {
    console.error("Image to text error", response);
    new import_obsidian3.Notice(`Image to text error: ${response.status}`);
    return "";
  }
  const result = response.json;
  let text = "";
  if (result.paragraphs_result) {
    result.paragraphs_result.forEach((item) => {
      for (let i = 0; i < item.words_result_idx.length; i++) {
        text += result.words_result[item.words_result_idx[i]].words + " ";
      }
      text += "\n";
    });
  }
  console.log("\u56FE\u7247\u8F6C\u6587\u5B57\u6BB5\u843D\u7ED3\u679C:", text);
  return text;
}

// src/prompt.ts
var GENERATE_SIMILAR_TOPIC_TEMPLATE = `
\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u5DF2\u6709\u7684\u9898\u76EE\u751F\u62105\u9053\u6269\u5C55\u9898\u76EE\uFF0C\u8FD9\u4E9B\u9898\u76EE\u8981\u7B26\u5408{GRADE}\u7684\u77E5\u8BC6\u6C34\u5E73\u3002

\u9996\u5148\uFF0C\u5DF2\u6709\u9898\u76EE\u5982\u4E0B\uFF1A
{TOPIC}

{GRADE}\u77E5\u8BC6\u6C34\u5E73\u7684\u51FA\u9898\u8981\u6C42\u5982\u4E0B\uFF1A
1. \u9898\u76EE\u4E0D\u80FD\u8FC7\u4E8E\u590D\u6742\uFF0C\u8981\u7B26\u5408{GRADE}\u5B66\u751F\u7684\u8BA4\u77E5\u80FD\u529B\u3002
2. \u5E94\u6DB5\u76D6{GRADE}\u8BFE\u7A0B\u4E2D\u7684\u5E38\u89C1\u77E5\u8BC6\u70B9\u3002

\u5728\u51FA\u9898\u65F6\uFF0C\u8BF7\u9075\u5FAA\u4EE5\u4E0B\u6307\u5BFC\uFF1A
1. \u5BF9\u4E8E\u6BCF\u4E00\u9053\u6269\u5C55\u9898\u76EE\uFF0C\u5C3D\u91CF\u4ECE\u4E0D\u540C\u7684\u77E5\u8BC6\u70B9\u89D2\u5EA6\u51FA\u53D1\uFF0C\u4F46\u8981\u57FA\u4E8E\u539F\u59CB\u9898\u76EE\u76F8\u5173\u7684\u77E5\u8BC6\u8303\u7574\u3002
2. \u5982\u679C\u539F\u59CB\u9898\u76EE\u662F\u6570\u5B66\u9898\uFF0C\u6269\u5C55\u9898\u76EE\u53EF\u4EE5\u6539\u53D8\u6570\u5B57\u3001\u8FD0\u7B97\u7B26\u53F7\u6216\u8005\u9898\u578B\u3002\u5982\u679C\u662F\u8BED\u6587\u9898\uFF0C\u53EF\u4EE5\u4ECE\u5B57\u8BCD\u3001\u8BED\u53E5\u7406\u89E3\u7B49\u4E0D\u540C\u65B9\u9762\u51FA\u9898\u3002
3. \u786E\u4FDD\u9898\u76EE\u8868\u8FF0\u6E05\u6670\uFF0C\u6CA1\u6709\u6B67\u4E49\u3002

\u8BF7\u6309\u7167\u4E0B\u9762\u7684\u683C\u5F0F\u7ED9\u51FA\u56DE\u7B54\uFF1A
\u6839\u636E\u4E0A\u8FF0\u9898\u76EE\u751F\u6210\u7684\u6269\u5C55\u9898\u76EE\u5982\u4E0B\uFF1A
\u9898\u76EE1
\u9898\u76EE2
...
`;
var GENERATE_LEARNING_POINTS_TEMPLATE = `
\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u7ED9\u5B9A\u7684\u9898\u76EE\u603B\u7ED3\u76F8\u5173\u77E5\u8BC6\u70B9\u3002\u8BF7\u4ED4\u7EC6\u9605\u8BFB\u4EE5\u4E0B\u9898\u76EE:
{TOPIC}

\u5728\u603B\u7ED3\u77E5\u8BC6\u70B9\u65F6\uFF0C\u8BF7\u6309\u7167\u4EE5\u4E0B\u6B65\u9AA4\u8FDB\u884C:
1. \u4ED4\u7EC6\u9605\u8BFB\u9898\u76EE\u5185\u5BB9\uFF0C\u786E\u5B9A\u9898\u76EE\u6D89\u53CA\u7684\u4E3B\u8981\u9886\u57DF\u6216\u4E3B\u9898\u3002
2. \u8BC6\u522B\u4E0E\u4E3B\u9898\u76F8\u5173\u7684\u5173\u952E\u6982\u5FF5\u3001\u539F\u7406\u6216\u4FE1\u606F\u3002
3. \u5C06\u8FD9\u4E9B\u6982\u5FF5\u3001\u539F\u7406\u6216\u4FE1\u606F\u8FDB\u884C\u5206\u7C7B\u6574\u7406\u3002
4. \u53BB\u9664\u5197\u4F59\u6216\u4E0D\u91CD\u8981\u7684\u4FE1\u606F\u3002

\u8BF7\u6309\u7167\u4E0B\u9762\u7684\u683C\u5F0F\u7ED9\u51FA\u56DE\u7B54\uFF1A
\u672C\u9898\u76EE\u4E3B\u8981\u6D89\u53CA\u5230\u7684\u77E5\u8BC6\u70B9\u5982\u4E0B\uFF1A
\u4F60\u7684\u7B54\u6848
...
`;

// src/llm.ts
var import_obsidian4 = require("obsidian");
async function sendLLMRequest(prompt, llmSettings) {
  try {
    const body = {
      "model": llmSettings.modelName,
      "tempreture": 1,
      "messages": [
        {
          "role": "system",
          "content": "\u4F60\u662F\u4E00\u4E2A\u5B66\u751F\u5B66\u4E60\u52A9\u7406\u3002"
        },
        {
          "role": "user",
          "content": prompt
        }
      ]
    };
    const jsonBody = JSON.stringify(body);
    const headers = {
      "Content-Type": "application/json",
      // 使用 API Key 进行鉴权
      "Authorization": `Bearer ${llmSettings.apiKey}`
    };
    const requestParam = {
      url: llmSettings.apiBase,
      method: "POST",
      headers,
      body: jsonBody
    };
    const response = await (0, import_obsidian4.requestUrl)(requestParam);
    if (response.status != 200) {
      console.error("Send llm request error", response);
      return "";
    }
    const result = response.json;
    return result.choices[0].message.content;
  } catch (error) {
    console.error("\u8C03\u7528\u5927\u6A21\u578B\u51FA\u9519:", error);
    throw error;
  }
}

// src/locales/en.ts
var pluginName = "Student Repo";
var similarTopics = "Similar Topics";
var learningPoints = "Learning Points";
var imageToText = "Image to Text";
var textToSpeech = "Text to Speech";
var translateText2 = "Translate";
var en_default = {
  pluginName: `${pluginName}`,
  similarTopics: `${similarTopics}`,
  learningPoints: `${learningPoints}`,
  imageToText: `${imageToText}`,
  textToSpeech: `${textToSpeech}`,
  translateText: `${translateText2}`,
  imageToTextMenu: `${pluginName}: ${imageToText}`,
  textToSpeechMenu: `${pluginName}: ${textToSpeech}`,
  translateTextMenu: `${pluginName}: ${translateText2}`,
  genSimilarTopicsMenu: `${pluginName}: ${similarTopics}`,
  genLearningPointsMenu: `${pluginName}: ${learningPoints}`,
  createNodeFromImagesMenu: `${pluginName}: Create note from images`,
  createNodeFromImageMenu: `${pluginName}: Create note from image`,
  analysisAndSummarize: `Analyze & Summarize`,
  // For settings
  llmProvider: "Alibaba Qwen",
  ocrProvider: "Baidu Cloud",
  ttsProvider: "Microsoft Azure",
  studentGrade: `Student Grade`,
  llmSetting: `LLM Settings`,
  speechSetting: "Speech and Translation",
  speechSubscriptionKey: "Speech Subscription Key",
  speechVoiceType: "Speech Voice Type",
  speechVoiceGB: "Great Britain",
  speechVoiceUS: "USA",
  mtSubscriptionKey: "Translation Subscription Key"
};

// src/locales/zh-CN.ts
var pluginName2 = "\u5B66\u751F\u77E5\u8BC6\u5E93";
var similarTopics2 = "\u9898\u76EE\u6269\u5C55";
var learningPoints2 = "\u77E5\u8BC6\u70B9\u5206\u6790";
var imageToText2 = "\u6587\u5B57\u8BC6\u522B";
var textToSpeech2 = "\u6587\u5B57\u8F6C\u8BED\u97F3";
var translateText3 = "\u7FFB\u8BD1";
var zh_CN_default = {
  pluginName: `${pluginName2}`,
  similarTopics: `${similarTopics2}`,
  learningPoints: `${learningPoints2}`,
  imageToText: `${imageToText2}`,
  textToSpeech: `${textToSpeech2}`,
  translateText: `${translateText3}`,
  imageToTextMenu: `${pluginName2}: ${imageToText2}`,
  textToSpeechMenu: `${pluginName2}: ${textToSpeech2}`,
  translateTextMenu: `${pluginName2}: ${translateText3}`,
  genSimilarTopicsMenu: `${pluginName2}: ${similarTopics2}`,
  genLearningPointsMenu: `${pluginName2}: ${learningPoints2}`,
  createNodeFromImagesMenu: `${pluginName2}: \u4ECE\u56FE\u7247\u751F\u6210\u7B14\u8BB0`,
  createNodeFromImageMenu: `${pluginName2}: \u4ECE\u56FE\u7247\u751F\u6210\u7B14\u8BB0`,
  analysisAndSummarize: `\u5206\u6790&\u6269\u5C55`,
  // For settings
  llmProvider: "\u963F\u91CC\u5343\u95EE",
  ocrProvider: "\u767E\u5EA6\u4E91",
  ttsProvider: "\u5FAE\u8F6FAzure",
  studentGrade: `\u5B66\u751F\u5E74\u7EA7`,
  llmSetting: `\u5927\u6A21\u578B\u914D\u7F6E`,
  speechSetting: "\u8BED\u97F3\u5408\u6210\u4E0E\u7FFB\u8BD1",
  speechSubscriptionKey: "\u8BED\u97F3\u670D\u52A1Key",
  speechVoiceType: "\u8BED\u97F3\u98CE\u683C",
  speechVoiceGB: "\u82F1\u5F0F",
  speechVoiceUS: "\u7F8E\u5F0F",
  mtSubscriptionKey: "\u7FFB\u8BD1\u670D\u52A1Key"
};

// src/main.ts
var StudentRepoPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    const locale = window.localStorage.getItem("language");
    this.trans = (locale == null ? void 0 : locale.startsWith("zh")) ? zh_CN_default : en_default;
    this.addSettingTab(new StudentRepoSettingTab(this.app, this));
    await this.loadSettings();
    console.log("Student Repository Helper loaded");
    console.log("Settings:", this.settings);
    console.log("Platform isDesktop:", import_obsidian5.Platform.isDesktop);
    console.log("Platform isMobile:", import_obsidian5.Platform.isMobile);
    console.log("Platform isWin:", import_obsidian5.Platform.isWin);
    this.registerFileMenu();
    this.registerEditorMenu();
    this.registerCommand();
  }
  registerFileMenu() {
    this.registerEvent(
      this.app.workspace.on("files-menu", (menu, files) => {
        var isImages = isImageFiles(files);
        if (isImages) {
          if (isImages) {
            menu.addItem((item) => {
              item.setTitle(this.trans.createNodeFromImagesMenu).setIcon("document").onClick(async () => {
                await createImagesNote(files);
              });
            });
          }
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("file-menu", (menu, file) => {
        const isImage = isFileImage(file.path);
        if (isImage) {
          menu.addItem((item) => {
            item.setTitle(this.trans.createNodeFromImageMenu).setIcon("document").onClick(async () => {
              var files = [file];
              await createImagesNote(files);
            });
          });
          menu.addItem((item) => {
            item.setTitle(this.trans.imageToTextMenu).setIcon("document").onClick(async () => {
              const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
              if (view) {
                await this.handleOcrRequest(file.path, view.editor);
              }
            });
          });
        }
      })
    );
  }
  async handleOcrRequest(imageFile, editor, line = -1) {
    console.log("\u6587\u5B57\u8BC6\u522B:", imageFile);
    const file = await this.getLinkedFile(imageFile);
    if (!file) {
      new import_obsidian5.Notice(`Image file not exist: ${imageFile}`);
    } else {
      new import_obsidian5.Notice(`\u5C06<${imageFile}>\u8F6C\u6210\u6587\u5B57`);
      var imageBuffer = await this.app.vault.adapter.readBinary(file.path);
      const isUpdate = await checkAccessToken(this.settings.ocrSettings);
      if (isUpdate) {
        await this.saveSettings();
      }
      const text = await imageToTextHttp(imageBuffer, this.settings.ocrSettings);
      if (line < 0) {
        line = editor.getCursor().line + 1;
      }
      const nextLinePos = { line, ch: 0 };
      editor.replaceRange(`${text}
`, nextLinePos);
    }
  }
  async handleImagesToTextRequest(mdFile, editor) {
    const mdContent = await this.app.vault.read(mdFile);
    const lines = mdContent.split("\n");
    const imageRegex = /!\[\[(.*\.(jpg|jpeg|png|bmp))\]\]/;
    for (let i = lines.length - 1; i >= 0; i--) {
      const line = lines[i];
      const match = line.match(imageRegex);
      if (match) {
        const imagePath = match[1];
        console.log(`Image match: ${imagePath} in line ${i}`);
        await this.handleOcrRequest(imagePath, editor, i + 1);
      }
    }
  }
  async handleTextToSpeechRequest(text, mdFile, editor) {
    const { full_path, rel_path } = await this.getAudioFilePath(mdFile, this.settings);
    console.time("textToSpeech");
    let audio_buffer = await textToSpeechHttp(text, this.settings.speechSettings.subscriptionKey, this.settings.speechSettings.speechVoice);
    await this.app.vault.adapter.writeBinary(rel_path, audio_buffer);
    console.timeEnd("textToSpeech");
    console.log(`Audio saved to ${rel_path}`);
    let md_text = `\`\`\`audio-player
 [[${rel_path}]]
\`\`\`
`;
    const startOffset = editor.getCursor("from");
    const nextLinePos = { line: startOffset.line, ch: 0 };
    editor.replaceRange(md_text, nextLinePos);
  }
  async handleTranslateTextRequest(text, editor) {
    let translatedText = await translateText(text, this.settings.mtSettings.language, this.settings.mtSettings.subscriptionKey);
    const endOffset = editor.getCursor("to");
    editor.replaceRange(`(${translatedText})`, endOffset);
  }
  async handleGenSimilarTopicRequest(topic, editor) {
    const prompt = GENERATE_SIMILAR_TOPIC_TEMPLATE.replace("{GRADE}", this.settings.stuSettings.grade).replace("{TOPIC}", topic);
    const result = await sendLLMRequest(prompt, this.settings.llmSettings);
    const endOffset = editor.getCursor("to");
    const nextLinePos = { line: endOffset.line + 1, ch: 0 };
    editor.replaceRange(`${addQuoteToText(result, this.trans.similarTopics)}

`, nextLinePos);
  }
  async handleGenLearningPointRequest(topic, editor) {
    const prompt = GENERATE_LEARNING_POINTS_TEMPLATE.replace("{TOPIC}", topic);
    const result = await sendLLMRequest(prompt, this.settings.llmSettings);
    const endOffset = editor.getCursor("to");
    const nextLinePos = { line: endOffset.line + 1, ch: 0 };
    editor.replaceRange(`${addQuoteToText(result, this.trans.learningPoints)}

`, nextLinePos);
  }
  registerEditorMenu() {
    if (!import_obsidian5.Platform.isDesktop) {
      return;
    }
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        const selection = editor.getSelection();
        console.log("selection:", selection);
        const imageRegex = /!?\[?\[?(.*\.(jpg|jpeg|png|bmp))\]?\]?/;
        const match = selection.match(imageRegex);
        if (!match) {
          menu.addItem((item) => {
            item.setTitle(this.trans.textToSpeechMenu).setIcon("document").onClick(async () => {
              this.handleTextToSpeechRequest(selection, view.file, editor);
            });
          });
          menu.addItem((item) => {
            item.setTitle(this.trans.translateTextMenu).setIcon("document").onClick(async () => {
              this.handleTranslateTextRequest(selection, editor);
            });
          });
          menu.addItem((item) => {
            item.setTitle(this.trans.genSimilarTopicsMenu).setIcon("document").onClick(async () => {
              this.handleGenSimilarTopicRequest(selection, editor);
            });
          });
          menu.addItem((item) => {
            item.setTitle(this.trans.genLearningPointsMenu).setIcon("document").onClick(async () => {
              this.handleGenLearningPointRequest(selection, editor);
            });
          });
        }
      })
    );
  }
  registerCommand() {
    this.addCommand({
      id: "translate",
      name: this.trans.translateText,
      icon: "languages",
      editorCallback: async (editor, view) => {
        const selection = editor.getSelection();
        console.log("selection:", selection);
        this.handleTranslateTextRequest(selection, editor);
      }
    });
    this.addCommand({
      id: "text_to_speech",
      name: this.trans.textToSpeech,
      icon: "activity",
      editorCallback: async (editor, view) => {
        const selection = editor.getSelection();
        console.log("selection:", selection);
        this.handleTextToSpeechRequest(selection, view.file, editor);
      }
    });
    this.addCommand({
      id: "gen_learning_point",
      name: this.trans.analysisAndSummarize,
      icon: "brain",
      editorCallback: async (editor, view) => {
        const selection = editor.getSelection();
        console.log("selection:", selection);
        this.handleGenSimilarTopicRequest(selection, editor);
        this.handleGenLearningPointRequest(selection, editor);
      }
    });
    this.addCommand({
      id: "image_to_text",
      name: this.trans.imageToText,
      icon: "type",
      editorCallback: async (editor, view) => {
        const selection = editor.getSelection();
        const imageRegex = /!?\[?\[?(.*\.(jpg|jpeg|png|bmp))\]?\]?/;
        const match = selection.match(imageRegex);
        if (match) {
          let imageFile = match[1];
          this.handleOcrRequest(imageFile, editor);
        } else {
          if (view) {
            this.handleImagesToTextRequest(view.file, editor);
          }
        }
      }
    });
  }
  async getLinkedFile(link) {
    const file = this.app.metadataCache.getFirstLinkpathDest(link, "");
    if (!file) {
      return null;
    }
    return this.app.vault.getAbstractFileByPath(file.path);
  }
  async getAudioFilePath(tfile, settings) {
    const audio_path = (0, import_obsidian5.normalizePath)(`${tfile.parent.path}/${settings.speechSettings.speechOutputPath}`);
    await this.app.vault.adapter.mkdir(audio_path);
    var audio_full_path = this.app.vault.adapter.getFullPath(audio_path);
    const output_fname = tfile.basename + ".mp3";
    const full_path = (0, import_obsidian5.normalizePath)(`${audio_full_path}/${output_fname}`);
    const rel_path = (0, import_obsidian5.normalizePath)(`${audio_path}/${output_fname}`);
    return { full_path, rel_path };
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
function isFileImage(path) {
  return path.endsWith(".png") || path.endsWith(".jpg") || path.endsWith(".jpeg") || path.endsWith(".webp") || path.endsWith(".gif") || path.endsWith(".bmp");
}
function isImageFiles(files) {
  var j;
  for (j in files) {
    var f_path = files[j].path;
    if (!isFileImage(f_path)) {
      return false;
    }
  }
  return true;
}
async function createNote(name, contents = "") {
  var _a, _b, _c;
  try {
    let pathPrefix;
    switch (app.vault.getConfig("newFileLocation")) {
      case "current":
        pathPrefix = (_c = (_b = (_a = app.workspace.getActiveFile()) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) != null ? _c : "";
        break;
      case "folder":
        pathPrefix = app.vault.getConfig("newFileFolderPath");
        break;
      default:
        pathPrefix = "";
        break;
    }
    if (pathPrefix) {
      pathPrefix += "/";
    }
    let path = `${pathPrefix}${name}`;
    console.log(`pathPrefix: ${pathPrefix}, name: ${name}`);
    if (app.vault.getAbstractFileByPath(`${path}.md`)) {
      let i = 1;
      while (await app.vault.getAbstractFileByPath(`${path} ${i}.md`)) {
        i++;
      }
      path += ` ${i}`;
    }
    await app.vault.create(`${path}.md`, contents);
    await app.workspace.openLinkText(path, "");
  } catch (e) {
    new import_obsidian5.Notice("Text Extract - Could not create note: " + e.message);
    throw e;
  }
}
async function createImagesNote(files) {
  var j;
  var file_paths = new Array(files.length);
  for (j in files) {
    console.log(`ppath: ${files[j].parent.path}, pname: ${files[j].parent.name}`);
    file_paths[j] = files[j].path;
  }
  file_paths.sort();
  var contents = "";
  for (j in file_paths) {
    console.log(file_paths[j]);
    contents += `![[${file_paths[j]}]]
`;
  }
  console.log(contents);
  await createNote("Untitled", contents);
}
function addQuoteToText(text, note) {
  return `
> [!NOTE] ${note}
` + text.split("\n").map((line) => `> ${line}`).join("\n");
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9tc19henVyZS50cyIsICJzcmMvYmFpZHVfYWkudHMiLCAic3JjL3Byb21wdC50cyIsICJzcmMvbGxtLnRzIiwgInNyYy9sb2NhbGVzL2VuLnRzIiwgInNyYy9sb2NhbGVzL3poLUNOLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luLCBUQWJzdHJhY3RGaWxlLCBURmlsZSwgUGxhdGZvcm0sIEVkaXRvciwgTWFya2Rvd25WaWV3LCBub3JtYWxpemVQYXRofSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBTdHVkZW50UmVwb1NldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBTdHVkZW50UmVwb1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcbmltcG9ydCB7IHRleHRUb1NwZWVjaEh0dHAsIHRyYW5zbGF0ZVRleHQsIGltYWdlVG9UZXh0IH0gZnJvbSBcIi4vbXNfYXp1cmVcIjtcbmltcG9ydCB7IGNoZWNrQWNjZXNzVG9rZW4sIGltYWdlVG9UZXh0SHR0cCB9IGZyb20gXCIuL2JhaWR1X2FpXCI7XG5pbXBvcnQgeyBHRU5FUkFURV9TSU1JTEFSX1RPUElDX1RFTVBMQVRFLCBHRU5FUkFURV9MRUFSTklOR19QT0lOVFNfVEVNUExBVEUgfSBmcm9tICcuL3Byb21wdCdcbmltcG9ydCB7IHNlbmRMTE1SZXF1ZXN0IH0gZnJvbSAnLi9sbG0nXG5pbXBvcnQgZW4gZnJvbSAnLi9sb2NhbGVzL2VuJ1xuaW1wb3J0IHpoIGZyb20gJy4vbG9jYWxlcy96aC1DTidcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3R1ZGVudFJlcG9QbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogU3R1ZGVudFJlcG9TZXR0aW5ncztcbiAgdHJhbnM6IGFueTtcblxuICBhc3luYyBvbmxvYWQoKSB7XG4gICAgY29uc3QgbG9jYWxlID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsYW5ndWFnZScpXG4gICAgdGhpcy50cmFucyA9IGxvY2FsZT8uc3RhcnRzV2l0aCgnemgnKSA/IHpoIDogZW47XG5cbiAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFN0dWRlbnRSZXBvU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgY29uc29sZS5sb2coJ1N0dWRlbnQgUmVwb3NpdG9yeSBIZWxwZXIgbG9hZGVkJyk7XG4gICAgY29uc29sZS5sb2coJ1NldHRpbmdzOicsIHRoaXMuc2V0dGluZ3MpO1xuICAgIGNvbnNvbGUubG9nKCdQbGF0Zm9ybSBpc0Rlc2t0b3A6JywgUGxhdGZvcm0uaXNEZXNrdG9wKTtcbiAgICBjb25zb2xlLmxvZygnUGxhdGZvcm0gaXNNb2JpbGU6JywgUGxhdGZvcm0uaXNNb2JpbGUpO1xuICAgIGNvbnNvbGUubG9nKCdQbGF0Zm9ybSBpc1dpbjonLCBQbGF0Zm9ybS5pc1dpbik7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRmlsZU1lbnUoKTtcbiAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yTWVudSgpO1xuICAgIHRoaXMucmVnaXN0ZXJDb21tYW5kKCk7XG5cdH1cblxuICByZWdpc3RlckZpbGVNZW51KCk6IHZvaWQge1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignZmlsZXMtbWVudScsIChtZW51LCBmaWxlcykgPT4ge1xuICAgICAgICB2YXIgaXNJbWFnZXMgPSBpc0ltYWdlRmlsZXMoZmlsZXMpXG4gICAgICAgIGlmIChpc0ltYWdlcykge1xuICAgICAgICAgIGlmIChpc0ltYWdlcykge1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUodGhpcy50cmFucy5jcmVhdGVOb2RlRnJvbUltYWdlc01lbnUpXG4gICAgICAgICAgICAgIC5zZXRJY29uKCdkb2N1bWVudCcpXG4gICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IGNyZWF0ZUltYWdlc05vdGUoZmlsZXMpXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBmaWxlKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzSW1hZ2UgPSBpc0ZpbGVJbWFnZShmaWxlLnBhdGgpXG4gICAgICAgIGlmIChpc0ltYWdlKSB7XG4gICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBpdGVtLnNldFRpdGxlKHRoaXMudHJhbnMuY3JlYXRlTm9kZUZyb21JbWFnZU1lbnUpXG4gICAgICAgICAgICAuc2V0SWNvbignZG9jdW1lbnQnKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMoKSA9PiB7XG4gICAgICAgICAgICAgIHZhciBmaWxlcyA9IFtmaWxlXVxuICAgICAgICAgICAgICBhd2FpdCBjcmVhdGVJbWFnZXNOb3RlKGZpbGVzKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUodGhpcy50cmFucy5pbWFnZVRvVGV4dE1lbnUpXG4gICAgICAgICAgICAuc2V0SWNvbignZG9jdW1lbnQnKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlT2NyUmVxdWVzdChmaWxlLnBhdGgsIHZpZXcuZWRpdG9yKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuXHRcdFx0fSlcblx0XHQpO1xuICB9XG5cbiAgYXN5bmMgaGFuZGxlT2NyUmVxdWVzdChpbWFnZUZpbGU6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IsIGxpbmU6IG51bWJlciA9IC0xKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc29sZS5sb2coJ1x1NjU4N1x1NUI1N1x1OEJDNlx1NTIyQjonLCBpbWFnZUZpbGUpO1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmdldExpbmtlZEZpbGUoaW1hZ2VGaWxlKTtcbiAgICBpZiAoIWZpbGUpIHtcbiAgICAgIG5ldyBOb3RpY2UoYEltYWdlIGZpbGUgbm90IGV4aXN0OiAke2ltYWdlRmlsZX1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV3IE5vdGljZShgXHU1QzA2PCR7aW1hZ2VGaWxlfT5cdThGNkNcdTYyMTBcdTY1ODdcdTVCNTdgKTtcbiAgICAgIHZhciBpbWFnZUJ1ZmZlcjogQXJyYXlCdWZmZXIgPSAgYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkQmluYXJ5KGZpbGUucGF0aClcbiAgICAgIC8vIFx1NEY3Rlx1NzUyOFx1NzY3RVx1NUVBNlx1NEU5MVx1NjNEMFx1NEY5Qlx1NzY4NFx1NjU4N1x1NUI1N1x1OEJDNlx1NTIyQlx1NjcwRFx1NTJBMVxuICAgICAgY29uc3QgaXNVcGRhdGUgPSBhd2FpdCBjaGVja0FjY2Vzc1Rva2VuKHRoaXMuc2V0dGluZ3Mub2NyU2V0dGluZ3MpO1xuICAgICAgaWYgKGlzVXBkYXRlKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICB9XG4gICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgaW1hZ2VUb1RleHRIdHRwKGltYWdlQnVmZmVyLCB0aGlzLnNldHRpbmdzLm9jclNldHRpbmdzKVxuICAgICAgLy8gXHU0RjdGXHU3NTI4XHU1RkFFXHU4RjZGXHU2M0QwXHU0RjlCXHU3Njg0b2NyXHU2NzBEXHU1MkExXG4gICAgICAvL2NvbnN0IHRleHQgPSBhd2FpdCBpbWFnZVRvVGV4dChpbWFnZUJ1ZmZlciwgXCJ0Y0k5NER4d2tTNXE3ZVg5UWpLc2p0V3NVTmd1NjBtOEJqcFRtblZjeDA0blFkYXU3UWRYSlFRSjk5QkJBQzNwS2FSWEozdzNBQUFGQUNPRzJSQzJcIilcbiAgICAgIGlmIChsaW5lIDwgMCkge1xuICAgICAgICBsaW5lID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgKyAxO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV4dExpbmVQb3MgPSB7bGluZTogbGluZSwgY2g6IDB9O1xuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShgJHt0ZXh0fVxcbmAsbmV4dExpbmVQb3MpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUltYWdlc1RvVGV4dFJlcXVlc3QobWRGaWxlOiBURmlsZSwgZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyBQYXJzZSBtZCBmaWxlLCBnZXQgYWxsIGltYWdlIGxpbmtzXG4gICAgY29uc3QgbWRDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChtZEZpbGUpO1xuICAgIGNvbnN0IGxpbmVzID0gbWRDb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBpbWFnZVJlZ2V4ID0gLyFcXFtcXFsoLipcXC4oanBnfGpwZWd8cG5nfGJtcCkpXFxdXFxdLztcbiAgICBmb3IgKGxldCBpID0gbGluZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaChpbWFnZVJlZ2V4KTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGNvbnN0IGltYWdlUGF0aCA9IG1hdGNoWzFdO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBJbWFnZSBtYXRjaDogJHtpbWFnZVBhdGh9IGluIGxpbmUgJHtpfWApXG4gICAgICAgICAgYXdhaXQgdGhpcy5oYW5kbGVPY3JSZXF1ZXN0KGltYWdlUGF0aCwgZWRpdG9yLCBpICsgMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlVGV4dFRvU3BlZWNoUmVxdWVzdCh0ZXh0OiBzdHJpbmcsIG1kRmlsZTogVEZpbGUsIGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBmdWxsX3BhdGgsIHJlbF9wYXRoIH0gPSBhd2FpdCB0aGlzLmdldEF1ZGlvRmlsZVBhdGgobWRGaWxlLCB0aGlzLnNldHRpbmdzKVxuICAgIFxuICAgIGNvbnNvbGUudGltZSgndGV4dFRvU3BlZWNoJylcbiAgICBsZXQgYXVkaW9fYnVmZmVyID0gYXdhaXQgdGV4dFRvU3BlZWNoSHR0cCh0ZXh0LCB0aGlzLnNldHRpbmdzLnNwZWVjaFNldHRpbmdzLnN1YnNjcmlwdGlvbktleSwgdGhpcy5zZXR0aW5ncy5zcGVlY2hTZXR0aW5ncy5zcGVlY2hWb2ljZSlcbiAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLndyaXRlQmluYXJ5KHJlbF9wYXRoLCBhdWRpb19idWZmZXIpXG4gICAgLy9hd2FpdCB0ZXh0VG9TcGVlY2godGV4dCwgZnVsbF9wYXRoLCB0aGlzLnNldHRpbmdzLnNwZWVjaFNldHRpbmdzLnN1YnNjcmlwdGlvbktleSwgdGhpcy5zZXR0aW5ncy5zcGVlY2hTZXR0aW5ncy5zcGVlY2hWb2ljZSlcbiAgICBjb25zb2xlLnRpbWVFbmQoJ3RleHRUb1NwZWVjaCcpXG4gICAgY29uc29sZS5sb2coYEF1ZGlvIHNhdmVkIHRvICR7cmVsX3BhdGh9YCk7XG4gICAgXG4gICAgbGV0IG1kX3RleHQgPSBgXFxgXFxgXFxgYXVkaW8tcGxheWVyXFxuIFtbJHtyZWxfcGF0aH1dXVxcblxcYFxcYFxcYFxcbmBcbiAgICBjb25zdCBzdGFydE9mZnNldCA9IGVkaXRvci5nZXRDdXJzb3IoJ2Zyb20nKTtcbiAgICBjb25zdCBuZXh0TGluZVBvcyA9IHtsaW5lOiBzdGFydE9mZnNldC5saW5lLCBjaDogMH07XG4gICAgZWRpdG9yLnJlcGxhY2VSYW5nZShtZF90ZXh0LCBuZXh0TGluZVBvcyk7XG4gIH1cblxuICBhc3luYyBoYW5kbGVUcmFuc2xhdGVUZXh0UmVxdWVzdCh0ZXh0OiBzdHJpbmcsIGVkaXRvcjogRWRpdG9yKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IHRyYW5zbGF0ZWRUZXh0ID0gYXdhaXQgdHJhbnNsYXRlVGV4dCh0ZXh0LCB0aGlzLnNldHRpbmdzLm10U2V0dGluZ3MubGFuZ3VhZ2UsIHRoaXMuc2V0dGluZ3MubXRTZXR0aW5ncy5zdWJzY3JpcHRpb25LZXkpXG4gICAgY29uc3QgZW5kT2Zmc2V0ID0gZWRpdG9yLmdldEN1cnNvcigndG8nKTtcbiAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGAoJHt0cmFuc2xhdGVkVGV4dH0pYCwgZW5kT2Zmc2V0KTtcbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUdlblNpbWlsYXJUb3BpY1JlcXVlc3QodG9waWM6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9tcHQgPSBHRU5FUkFURV9TSU1JTEFSX1RPUElDX1RFTVBMQVRFLnJlcGxhY2UoJ3tHUkFERX0nLCB0aGlzLnNldHRpbmdzLnN0dVNldHRpbmdzLmdyYWRlKS5yZXBsYWNlKCd7VE9QSUN9JywgdG9waWMpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlbmRMTE1SZXF1ZXN0KHByb21wdCwgdGhpcy5zZXR0aW5ncy5sbG1TZXR0aW5ncyk7XG4gICAgY29uc3QgZW5kT2Zmc2V0ID0gZWRpdG9yLmdldEN1cnNvcigndG8nKTtcbiAgICBjb25zdCBuZXh0TGluZVBvcyA9IHtsaW5lOiBlbmRPZmZzZXQubGluZSArIDEsIGNoOiAwfTtcbiAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGAke2FkZFF1b3RlVG9UZXh0KHJlc3VsdCwgdGhpcy50cmFucy5zaW1pbGFyVG9waWNzKX1cXG5cXG5gLCBuZXh0TGluZVBvcyk7XG4gIH1cblxuICBhc3luYyBoYW5kbGVHZW5MZWFybmluZ1BvaW50UmVxdWVzdCh0b3BpYzogc3RyaW5nLCBlZGl0b3I6IEVkaXRvcik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHByb21wdCA9IEdFTkVSQVRFX0xFQVJOSU5HX1BPSU5UU19URU1QTEFURS5yZXBsYWNlKCd7VE9QSUN9JywgdG9waWMpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlbmRMTE1SZXF1ZXN0KHByb21wdCwgdGhpcy5zZXR0aW5ncy5sbG1TZXR0aW5ncyk7XG4gICAgY29uc3QgZW5kT2Zmc2V0ID0gZWRpdG9yLmdldEN1cnNvcigndG8nKTtcbiAgICBjb25zdCBuZXh0TGluZVBvcyA9IHtsaW5lOiBlbmRPZmZzZXQubGluZSArIDEsIGNoOiAwfTtcbiAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGAke2FkZFF1b3RlVG9UZXh0KHJlc3VsdCwgdGhpcy50cmFucy5sZWFybmluZ1BvaW50cyl9XFxuXFxuYCwgbmV4dExpbmVQb3MpO1xuICB9XG5cbiAgcmVnaXN0ZXJFZGl0b3JNZW51KCk6IHZvaWQge1xuICAgIGlmICghUGxhdGZvcm0uaXNEZXNrdG9wKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudSwgZWRpdG9yLCB2aWV3KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdGlvbjonLCBzZWxlY3Rpb24pO1xuICAgICAgICBjb25zdCBpbWFnZVJlZ2V4ID0gLyE/XFxbP1xcWz8oLipcXC4oanBnfGpwZWd8cG5nfGJtcCkpXFxdP1xcXT8vO1xuICAgICAgICBjb25zdCBtYXRjaCA9IHNlbGVjdGlvbi5tYXRjaChpbWFnZVJlZ2V4KTtcbiAgICAgICAgLyoqXG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgaXRlbS5zZXRUaXRsZSh0aGlzLnRyYW5zLmltYWdlVG9UZXh0TWVudSlcbiAgICAgICAgICAgIC5zZXRJY29uKCdkb2N1bWVudCcpXG4gICAgICAgICAgICAub25DbGljayhhc3luYygpID0+IHtcbiAgICAgICAgICAgICAgbGV0IGltYWdlRmlsZSA9IG1hdGNoWzFdXG4gICAgICAgICAgICAgIHRoaXMuaGFuZGxlT2NyUmVxdWVzdChpbWFnZUZpbGUsIGVkaXRvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAqL1xuICAgICAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgICAgLy8gQ3JlYXRlIEF1ZGlvXG4gICAgICAgICAgbWVudS5hZGRJdGVtKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAuc2V0VGl0bGUodGhpcy50cmFucy50ZXh0VG9TcGVlY2hNZW51KVxuICAgICAgICAgICAgICAuc2V0SWNvbignZG9jdW1lbnQnKVxuICAgICAgICAgICAgICAub25DbGljayhhc3luYygpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVRleHRUb1NwZWVjaFJlcXVlc3Qoc2VsZWN0aW9uLCB2aWV3LmZpbGUsIGVkaXRvcilcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcblxuICAgICAgICAgIC8vIFRyYW5zbGF0ZVxuICAgICAgICAgIG1lbnUuYWRkSXRlbShpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgLnNldFRpdGxlKHRoaXMudHJhbnMudHJhbnNsYXRlVGV4dE1lbnUpXG4gICAgICAgICAgICAgIC5zZXRJY29uKCdkb2N1bWVudCcpXG4gICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlVHJhbnNsYXRlVGV4dFJlcXVlc3Qoc2VsZWN0aW9uLCBlZGl0b3IpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgLy8gXHU5ODk4XHU3NkVFXHU2MjY5XHU1QzU1XG4gICAgICAgICAgbWVudS5hZGRJdGVtKGl0ZW0gPT4ge1xuICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAuc2V0VGl0bGUodGhpcy50cmFucy5nZW5TaW1pbGFyVG9waWNzTWVudSlcbiAgICAgICAgICAgICAgLnNldEljb24oJ2RvY3VtZW50JylcbiAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVHZW5TaW1pbGFyVG9waWNSZXF1ZXN0KHNlbGVjdGlvbiwgZWRpdG9yKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcblxuICAgICAgICAgIC8vIFx1NzdFNVx1OEJDNlx1NzBCOVx1NTIwNlx1Njc5MFxuICAgICAgICAgIG1lbnUuYWRkSXRlbShpdGVtID0+IHtcbiAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgLnNldFRpdGxlKHRoaXMudHJhbnMuZ2VuTGVhcm5pbmdQb2ludHNNZW51KVxuICAgICAgICAgICAgICAuc2V0SWNvbignZG9jdW1lbnQnKVxuICAgICAgICAgICAgICAub25DbGljayhhc3luYygpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUdlbkxlYXJuaW5nUG9pbnRSZXF1ZXN0KHNlbGVjdGlvbiwgZWRpdG9yKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICB9KVxuICAgIClcbiAgfVxuXG4gIHJlZ2lzdGVyQ29tbWFuZCgpOiB2b2lkIHtcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6ICd0cmFuc2xhdGUnLFxuICAgICAgbmFtZTogdGhpcy50cmFucy50cmFuc2xhdGVUZXh0LFxuICAgICAgaWNvbjogXCJsYW5ndWFnZXNcIixcbiAgICAgIGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3Rpb246Jywgc2VsZWN0aW9uKTtcbiAgICAgICAgdGhpcy5oYW5kbGVUcmFuc2xhdGVUZXh0UmVxdWVzdChzZWxlY3Rpb24sIGVkaXRvcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgaWQ6ICd0ZXh0X3RvX3NwZWVjaCcsXG4gICAgICBuYW1lOiB0aGlzLnRyYW5zLnRleHRUb1NwZWVjaCxcbiAgICAgIGljb246IFwiYWN0aXZpdHlcIixcbiAgICAgIGVkaXRvckNhbGxiYWNrOiBhc3luYyAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3Rpb246Jywgc2VsZWN0aW9uKTtcbiAgICAgICAgdGhpcy5oYW5kbGVUZXh0VG9TcGVlY2hSZXF1ZXN0KHNlbGVjdGlvbiwgdmlldy5maWxlLCBlZGl0b3IpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgIGlkOiAnZ2VuX2xlYXJuaW5nX3BvaW50JyxcbiAgICAgIG5hbWU6IHRoaXMudHJhbnMuYW5hbHlzaXNBbmRTdW1tYXJpemUsXG4gICAgICBpY29uOiBcImJyYWluXCIsXG4gICAgICBlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0aW9uOicsIHNlbGVjdGlvbik7XG4gICAgICAgIHRoaXMuaGFuZGxlR2VuU2ltaWxhclRvcGljUmVxdWVzdChzZWxlY3Rpb24sIGVkaXRvcik7XG4gICAgICAgIHRoaXMuaGFuZGxlR2VuTGVhcm5pbmdQb2ludFJlcXVlc3Qoc2VsZWN0aW9uLCBlZGl0b3IpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgIGlkOiAnaW1hZ2VfdG9fdGV4dCcsXG4gICAgICBuYW1lOiB0aGlzLnRyYW5zLmltYWdlVG9UZXh0LFxuICAgICAgaWNvbjogXCJ0eXBlXCIsXG4gICAgICBlZGl0b3JDYWxsYmFjazogYXN5bmMgKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuICAgICAgICBjb25zdCBpbWFnZVJlZ2V4ID0gLyE/XFxbP1xcWz8oLipcXC4oanBnfGpwZWd8cG5nfGJtcCkpXFxdP1xcXT8vO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBzZWxlY3Rpb24ubWF0Y2goaW1hZ2VSZWdleCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGxldCBpbWFnZUZpbGUgPSBtYXRjaFsxXVxuICAgICAgICAgIHRoaXMuaGFuZGxlT2NyUmVxdWVzdChpbWFnZUZpbGUsIGVkaXRvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlSW1hZ2VzVG9UZXh0UmVxdWVzdCh2aWV3LmZpbGUsIGVkaXRvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRMaW5rZWRGaWxlKGxpbms6IHN0cmluZyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG4gICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGluaywgJycpO1xuICAgIGlmICghZmlsZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZS5wYXRoKTtcbiAgfVxuXG4gIGFzeW5jIGdldEF1ZGlvRmlsZVBhdGgodGZpbGU6IFRGaWxlLCBzZXR0aW5nczogU3R1ZGVudFJlcG9TZXR0aW5ncyk6IHtmdWxsX3BhdGg6IHN0cmluZzsgcmVsX3BhdGg6IHN0cmluZ30ge1xuICAgIC8vIENyZWF0ZSBvdXRwdXQgYXVkaW8gZGlyXG4gICAgY29uc3QgYXVkaW9fcGF0aCA9IG5vcm1hbGl6ZVBhdGgoYCR7dGZpbGUucGFyZW50LnBhdGh9LyR7c2V0dGluZ3Muc3BlZWNoU2V0dGluZ3Muc3BlZWNoT3V0cHV0UGF0aH1gKVxuICAgIC8vY29uc29sZS5sb2coYGF1ZGlvX3BhdGg6ICR7YXVkaW9fcGF0aH1gKVxuICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIubWtkaXIoYXVkaW9fcGF0aClcbiAgICAvLyBHZXQgb3V0cHV0IG1wMyBmaWxlIHBhdGhcbiAgICB2YXIgYXVkaW9fZnVsbF9wYXRoID0gdGhpcy5hcHAudmF1bHQuYWRhcHRlci5nZXRGdWxsUGF0aChhdWRpb19wYXRoKVxuICAgIC8vY29uc29sZS5sb2coYGF1ZGlvX2Z1bGxfcGF0aDogJHthdWRpb19mdWxsX3BhdGh9YClcbiAgICBjb25zdCBvdXRwdXRfZm5hbWUgPSB0ZmlsZS5iYXNlbmFtZSArICcubXAzJztcbiAgICAvL2NvbnNvbGUubG9nKGBvdXRwdXRfZm5hbWU6ICR7b3V0cHV0X2ZuYW1lfWApXG5cbiAgICBjb25zdCBmdWxsX3BhdGggPSBub3JtYWxpemVQYXRoKGAke2F1ZGlvX2Z1bGxfcGF0aH0vJHtvdXRwdXRfZm5hbWV9YCk7XG4gICAgLy9jb25zb2xlLmxvZyhgZnVsbF9wYXRoOiAke2Z1bGxfcGF0aH1gKVxuICAgIGNvbnN0IHJlbF9wYXRoID0gbm9ybWFsaXplUGF0aChgJHthdWRpb19wYXRofS8ke291dHB1dF9mbmFtZX1gKTtcbiAgICAvL2NvbnNvbGUubG9nKGByZWxfcGF0aDogJHtyZWxfcGF0aH1gKVxuICAgIFxuICAgIHJldHVybiB7ZnVsbF9wYXRoLCByZWxfcGF0aH07XG4gIH1cblxuXHRvbnVubG9hZCgpIHtcblx0fVxuXG4gIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgfVxuXG4gIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzRmlsZU1hcmtkb3duKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gcGF0aC5lbmRzV2l0aCgnLm1kJylcbn1cblxuZnVuY3Rpb24gaXNGaWxlSW1hZ2UocGF0aDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAoXG4gICAgcGF0aC5lbmRzV2l0aCgnLnBuZycpIHx8IHBhdGguZW5kc1dpdGgoJy5qcGcnKSB8fCBwYXRoLmVuZHNXaXRoKCcuanBlZycpIHx8XG4gICAgcGF0aC5lbmRzV2l0aCgnLndlYnAnKSB8fCBwYXRoLmVuZHNXaXRoKCcuZ2lmJykgfHwgcGF0aC5lbmRzV2l0aCgnLmJtcCcpXG4gIClcbn1cblxuZnVuY3Rpb24gaXNJbWFnZUZpbGVzKGZpbGVzOiBURmlsZVtdKTogYm9vbGVhbiB7XG4gIHZhciBqOmFueVxuICBmb3IgKGogaW4gZmlsZXMpIHtcbiAgICB2YXIgZl9wYXRoID0gZmlsZXNbal0ucGF0aFxuICAgIGlmICghaXNGaWxlSW1hZ2UoZl9wYXRoKSkge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU5vdGUobmFtZTogc3RyaW5nLCBjb250ZW50cyA9ICcnKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgbGV0IHBhdGhQcmVmaXg6IHN0cmluZ1xuICAgIHN3aXRjaCAoYXBwLnZhdWx0LmdldENvbmZpZygnbmV3RmlsZUxvY2F0aW9uJykpIHtcbiAgICAgIGNhc2UgJ2N1cnJlbnQnOlxuICAgICAgICBwYXRoUHJlZml4ID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhcmVudD8ucGF0aCA/PyAnJ1xuICAgICAgICBicmVha1xuICAgICAgY2FzZSAnZm9sZGVyJzpcbiAgICAgICAgcGF0aFByZWZpeCA9IGFwcC52YXVsdC5nZXRDb25maWcoJ25ld0ZpbGVGb2xkZXJQYXRoJykgYXMgc3RyaW5nXG4gICAgICAgIGJyZWFrXG4gICAgICBkZWZhdWx0OiAvLyAncm9vdCdcbiAgICAgICAgcGF0aFByZWZpeCA9ICcnXG4gICAgICAgIGJyZWFrXG4gICAgfVxuICAgIFxuICAgIGlmIChwYXRoUHJlZml4KSB7XG4gICAgICBwYXRoUHJlZml4ICs9ICcvJ1xuICAgIH1cbiAgICBsZXQgcGF0aCA9IGAke3BhdGhQcmVmaXh9JHtuYW1lfWBcbiAgICBjb25zb2xlLmxvZyhgcGF0aFByZWZpeDogJHtwYXRoUHJlZml4fSwgbmFtZTogJHtuYW1lfWApXG4gICAgLy8gQ2hlY2sgaWYgZmlsZSBhbHJlYWR5IGV4aXN0c1xuICAgIGlmIChhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke3BhdGh9Lm1kYCkpIHtcbiAgICAgIC8vIEFwcGVuZCBhIG51bWJlciB0byB0aGUgZW5kIG9mIHRoZSBmaWxlIG5hbWVcbiAgICAgIGxldCBpID0gMVxuICAgICAgd2hpbGUgKGF3YWl0IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7cGF0aH0gJHtpfS5tZGApKSB7XG4gICAgICAgIGkrK1xuICAgICAgfVxuICAgICAgcGF0aCArPSBgICR7aX1gXG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGFuZCBvcGVuIHRoZSBmaWxlXG4gICAgYXdhaXQgYXBwLnZhdWx0LmNyZWF0ZShgJHtwYXRofS5tZGAsIGNvbnRlbnRzKVxuICAgIGF3YWl0IGFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHBhdGgsICcnKVxuICB9IGNhdGNoIChlKSB7XG4gICAgbmV3IE5vdGljZSgnVGV4dCBFeHRyYWN0IC0gQ291bGQgbm90IGNyZWF0ZSBub3RlOiAnICsgKGUgYXMgYW55KS5tZXNzYWdlKVxuICAgIHRocm93IGVcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVJbWFnZXNOb3RlKGZpbGVzOiBURmlsZVtdKSB7XG4gIHZhciBqOmFueVxuICB2YXIgZmlsZV9wYXRoczpzdHJpbmdbXSA9IG5ldyBBcnJheShmaWxlcy5sZW5ndGgpXG4gIGZvciAoaiBpbiBmaWxlcykge1xuICAgIGNvbnNvbGUubG9nKGBwcGF0aDogJHtmaWxlc1tqXS5wYXJlbnQucGF0aH0sIHBuYW1lOiAke2ZpbGVzW2pdLnBhcmVudC5uYW1lfWApXG4gICAgZmlsZV9wYXRoc1tqXSA9IGZpbGVzW2pdLnBhdGhcbiAgfVxuICBmaWxlX3BhdGhzLnNvcnQoKVxuICB2YXIgY29udGVudHM6c3RyaW5nID0gJydcbiAgZm9yIChqIGluIGZpbGVfcGF0aHMpIHtcbiAgICBjb25zb2xlLmxvZyhmaWxlX3BhdGhzW2pdKVxuICAgIGNvbnRlbnRzICs9IGAhW1ske2ZpbGVfcGF0aHNbal19XV1cXG5gXG4gIH1cbiAgY29uc29sZS5sb2coY29udGVudHMpXG4gIC8vIENyZWF0ZSBhIG5ldyBub3RlIGFuZCBvcGVuIGl0XG4gIGF3YWl0IGNyZWF0ZU5vdGUoXCJVbnRpdGxlZFwiLCBjb250ZW50cylcbn1cblxuZnVuY3Rpb24gYWRkUXVvdGVUb1RleHQodGV4dDogc3RyaW5nLCBub3RlOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gYFxcbj4gWyFOT1RFXSAke25vdGV9XFxuYCArIHRleHQuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IGA+ICR7bGluZX1gKS5qb2luKCdcXG4nKVxufSIsICJpbXBvcnQgU3R1ZGVudFJlcG9QbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3R1ZGVudFNldHRpbmdzIHtcbiAgZ3JhZGU6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBY2Nlc3NUb2tlbiB7XG4gIHRva2VuOiBzdHJpbmdcblx0ZXhwOiBudW1iZXJcbn1cbmV4cG9ydCBpbnRlcmZhY2UgT2NyU2V0dGluZ3Mge1xuICBhcHBJRDogc3RyaW5nO1xuICBhcGlLZXk6IHN0cmluZztcbiAgYXBpU2VjcmV0OiBzdHJpbmc7XG4gIGFjY2Vzc1Rva2VuOiBBY2Nlc3NUb2tlbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMTE1TZXR0aW5ncyB7XG4gIGFwaUJhc2U6IHN0cmluZztcbiAgYXBpS2V5OiBzdHJpbmc7XG4gIG1vZGVsTmFtZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zbGF0aW9uU2V0dGluZ3Mge1xuICBzdWJzY3JpcHRpb25LZXk6IHN0cmluZztcbiAgbGFuZ3VhZ2U6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTcGVlY2hTZXR0aW5ncyB7XG4gIHN1YnNjcmlwdGlvbktleTogc3RyaW5nO1xuICBzcGVlY2hWb2ljZTogc3RyaW5nXG4gIHNwZWVjaExhbmd1YWdlOiBzdHJpbmcsXG4gIHNwZWVjaE91dHB1dFBhdGg6IHN0cmluZyxcbn1cbmV4cG9ydCBpbnRlcmZhY2UgU3R1ZGVudFJlcG9TZXR0aW5ncyB7XG4gIHN0dVNldHRpbmdzOiBTdHVkZW50U2V0dGluZ3M7XG4gIHNwZWVjaFNldHRpbmdzOiBTcGVlY2hTZXR0aW5ncztcbiAgb2NyU2V0dGluZ3M6IE9jclNldHRpbmdzO1xuICBsbG1TZXR0aW5nczogTExNU2V0dGluZ3M7XG4gIG10U2V0dGluZ3M6IFRyYW5zbGF0aW9uU2V0dGluZ3M7XG59XG5cblxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogU3R1ZGVudFJlcG9TZXR0aW5ncyA9IHtcbiAgc3R1U2V0dGluZ3M6IHtcbiAgICBncmFkZTogJ1x1NUMwRlx1NUI2Nlx1NTZEQlx1NUU3NFx1N0VBNydcbiAgfSxcbiAgc3BlZWNoU2V0dGluZ3M6IHtcbiAgICBzdWJzY3JpcHRpb25LZXk6ICcnLFxuICAgIHNwZWVjaExhbmd1YWdlOiAnZW4nLFxuICAgIHNwZWVjaFZvaWNlOiAnZW4tR0ItU29uaWFOZXVyYWwnLFxuICAgIHNwZWVjaE91dHB1dFBhdGg6ICdfYXVkaW9zJyxcbiAgfSxcbiAgb2NyU2V0dGluZ3M6IHtcbiAgICBhcHBJRDogJycsXG4gICAgYXBpS2V5OiAnJyxcbiAgICBhcGlTZWNyZXQ6ICcnLFxuICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICB0b2tlbjogJycsXG4gICAgICBleHA6IDBcbiAgICB9LFxuICB9LFxuICBsbG1TZXR0aW5nczoge1xuICAgIGFwaUJhc2U6ICcnLFxuICAgIGFwaUtleTogJycsXG4gICAgbW9kZWxOYW1lOiAnJ1xuICB9LFxuICBtdFNldHRpbmdzOiB7XG4gICAgbGFuZ3VhZ2U6ICd6aC1IYW5zJyxcbiAgICBzdWJzY3JpcHRpb25LZXk6ICcnXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFN0dWRlbnRSZXBvU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICBwbHVnaW46IFN0dWRlbnRSZXBvUGx1Z2luO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFN0dWRlbnRSZXBvUGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG5cbiAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICBsZXQge2NvbnRhaW5lckVsfSA9IHRoaXM7XG4gICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMScsIHt0ZXh0OiB0aGlzLnBsdWdpbi50cmFucy5wbHVnaW5OYW1lfSk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSh0aGlzLnBsdWdpbi50cmFucy5zdHVkZW50R3JhZGUpXG4gICAgICAuc2V0RGVzYyh0aGlzLnBsdWdpbi50cmFucy5zdHVkZW50R3JhZGUpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdcdTVDMEZcdTVCNjZcdTU2REJcdTVFNzRcdTdFQTcnKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3R1U2V0dGluZ3MuZ3JhZGUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdHVTZXR0aW5ncy5ncmFkZSA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogdGhpcy5wbHVnaW4udHJhbnMubGxtU2V0dGluZ30pO1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0FQSSBVUkwnKVxuICAgICAgLnNldERlc2MoYCR7dGhpcy5wbHVnaW4udHJhbnMubGxtUHJvdmlkZXJ9IExMTSBBUEkgVVJMYClcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2h0dHBzOi8vZGFzaHNjb3BlLmFsaXl1bmNzLmNvbS9jb21wYXRpYmxlLW1vZGUvdjEvY2hhdC9jb21wbGV0aW9ucycpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5sbG1TZXR0aW5ncy5hcGlCYXNlKVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubGxtU2V0dGluZ3MuYXBpQmFzZSA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSgnQVBJIEtleScpXG4gICAgICAuc2V0RGVzYyhgJHt0aGlzLnBsdWdpbi50cmFucy5sbG1Qcm92aWRlcn0gTExNIEFQSSBLZXlgKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignc2stKioqJylcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxsbVNldHRpbmdzLmFwaUtleSlcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmxsbVNldHRpbmdzLmFwaUtleSA9IHZhbHVlO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAuc2V0TmFtZSgnTW9kZWwgTmFtZScpXG4gICAgICAuc2V0RGVzYyhgJHt0aGlzLnBsdWdpbi50cmFucy5sbG1Qcm92aWRlcn0gTExNIE1vZGVsIE5hbWVgKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcigncXdlbi10dXJibycpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5sbG1TZXR0aW5ncy5tb2RlbE5hbWUpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5sbG1TZXR0aW5ncy5tb2RlbE5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuICAgIFxuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHt0ZXh0OiB0aGlzLnBsdWdpbi50cmFucy5pbWFnZVRvVGV4dH0pO1xuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUoJ0FQUCBJRCcpXG4gICAgICAuc2V0RGVzYyhgJHt0aGlzLnBsdWdpbi50cmFucy5vY3JQcm92aWRlcn0gQVBQIElEYClcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1x1NEY2MFx1NzUzM1x1OEJGN1x1NTIzMFx1NzY4NEFQUCBJRCcpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vY3JTZXR0aW5ncy5hcHBJRClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9jclNldHRpbmdzLmFwcElEID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdBUEkgS2V5JylcbiAgICAgIC5zZXREZXNjKGAke3RoaXMucGx1Z2luLnRyYW5zLm9jclByb3ZpZGVyfSBBUEkgS2V5YClcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1x1NEY2MFx1NzUzM1x1OEJGN1x1NTIzMFx1NzY4NEFQSSBLZXknKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpS2V5KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpS2V5ID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdBUEkgU2VjcmV0JylcbiAgICAgIC5zZXREZXNjKGAke3RoaXMucGx1Z2luLnRyYW5zLm9jclByb3ZpZGVyfSBBUEkgU2VjcmV0YClcbiAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1x1NEY2MFx1NzUzM1x1OEJGN1x1NTIzMFx1NzY4NEFQSSBTZWNyZXQnKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpU2VjcmV0KVxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpU2VjcmV0ID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgICAvKipcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1x1OTdGM1x1OTg5MVx1NTQwOFx1NjIxMCd9KTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdcdTk3RjNcdTk4OTFcdThCRURcdThBMDAnKVxuICAgICAgLnNldERlc2MoJ1x1NzUxRlx1NjIxMFx1OTdGM1x1OTg5MVx1NzY4NFx1OEJFRFx1OEEwMCcpXG4gICAgICAuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PiB7XG4gICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignZW4nLCAnXHU4MkYxXHU4QkVEJyk7XG4gICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignemgtY24nLCAnXHU2NjZFXHU5MDFBXHU4QkREJyk7XG4gICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNwZWVjaExhbmd1YWdlKTtcbiAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoKG9wdGlvbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BlZWNoTGFuZ3VhZ2UgPSBvcHRpb247XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKCdcdTk3RjNcdTk4OTFcdTRGRERcdTVCNThcdTc2RUVcdTVGNTUnKVxuICAgICAgLnNldERlc2MoJ1x1OTdGM1x1OTg5MVx1NUI1OFx1NjUzRVx1NEY0RFx1N0Y2RScpXG4gICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdfYXVkaW8nKVxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3BlZWNoT3V0cHV0UGF0aClcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNwZWVjaE91dHB1dFBhdGggPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuICAgICovXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6IHRoaXMucGx1Z2luLnRyYW5zLnNwZWVjaFNldHRpbmd9KTtcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgIC5zZXROYW1lKHRoaXMucGx1Z2luLnRyYW5zLnNwZWVjaFN1YnNjcmlwdGlvbktleSlcbiAgICAgIC5zZXREZXNjKCdNaWNyb3NvZnQgQXp1cmUgU3BlZWNoIFN1YnNjcmlwdGlvbiBLZXknKVxuICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgIC5zZXRQbGFjZWhvbGRlcignWW91ciBBenVyZSBTcGVlY2ggU3Vic2NyaXB0aW9uIEtleScpXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGVlY2hTZXR0aW5ncy5zdWJzY3JpcHRpb25LZXkpXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGVlY2hTZXR0aW5ncy5zdWJzY3JpcHRpb25LZXkgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgLnNldE5hbWUodGhpcy5wbHVnaW4udHJhbnMuc3BlZWNoVm9pY2VUeXBlKVxuICAgICAgLnNldERlc2MoJ1NwZWVjaCBWb2ljZSBUeXBlJylcbiAgICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcbiAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCdlbi1HQi1Tb25pYU5ldXJhbCcsIHRoaXMucGx1Z2luLnRyYW5zLnNwZWVjaFZvaWNlR0IpO1xuICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJ2VuLVVTLUFtYW5kYU11bHRpbGluZ3VhbE5ldXJhbCcsIHRoaXMucGx1Z2luLnRyYW5zLnNwZWVjaFZvaWNlVVMpO1xuICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zcGVlY2hTZXR0aW5ncy5zcGVlY2hWb2ljZSk7XG4gICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKChvcHRpb24pID0+IHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNwZWVjaFNldHRpbmdzLnNwZWVjaFZvaWNlID0gb3B0aW9uO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgLnNldE5hbWUodGhpcy5wbHVnaW4udHJhbnMubXRTdWJzY3JpcHRpb25LZXkpXG4gICAgLnNldERlc2MoJ01pY3Jvc29mdCBBenVyZSBUcmFuc2xhdG9yIFN1YnNjcmlwdGlvbiBLZXknKVxuICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgLnNldFBsYWNlaG9sZGVyKCdZb3VyIEF6dXJlIFRyYW5zbGF0b3IgU3Vic2NyaXB0aW9uIEtleScpXG4gICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXRTZXR0aW5ncy5zdWJzY3JpcHRpb25LZXkpXG4gICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm10U2V0dGluZ3Muc3Vic2NyaXB0aW9uS2V5ID0gdmFsdWU7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgfSkpO1xuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgIC5zZXROYW1lKCdcdTdGRkJcdThCRDFcdThCRURcdThBMDAnKVxuICAgIC5zZXREZXNjKCdcdTdGRkJcdThCRDFcdTc2ODRcdTc2RUVcdTY4MDdcdThCRURcdThBMDAnKVxuICAgIC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+IHtcbiAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignZW4nLCAnRW5nbGlzaCcpO1xuICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCd6aC1IYW5zJywgJ1x1NjY2RVx1OTAxQVx1OEJERCcpO1xuICAgICAgZHJvcGRvd24uc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXRTZXR0aW5ncy5sYW5ndWFnZSk7XG4gICAgICBkcm9wZG93bi5vbkNoYW5nZSgob3B0aW9uKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubXRTZXR0aW5ncy5sYW5ndWFnZSA9IG9wdGlvbjtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufSIsICJpbXBvcnQgeyByZXF1ZXN0VXJsLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5jb25zdCBzZXJ2aWNlUmVnaW9uID0gXCJlYXN0YXNpYVwiO1xuXG4vLyBcdTkxNERcdTdGNkUgQXp1cmUgXHU4QkVEXHU5N0YzXHU2NzBEXHU1MkExXG5jb25zdCBzcGVlY2hTdWJzY3JpcHRpb25LZXkgPSBcIkVXMXpBM21iU2pqMWk3cWZrcFVONkhYYVN0Y3VVYVhuR2xnREVGSkNGbllRbGNYTHphNnRKUVFKOTlCQkFDM3BLYVJYSjN3M0FBQVlBQ09HcFgwS1wiO1xuY29uc3Qgc3BlZWNoQXBpVXJsID0gYGh0dHBzOi8vJHtzZXJ2aWNlUmVnaW9ufS50dHMuc3BlZWNoLm1pY3Jvc29mdC5jb20vY29nbml0aXZlc2VydmljZXMvdjFgO1xuXG4vL1x1OTE0RFx1N0Y2RSBBenVyZSBcdTdGRkJcdThCRDFcdTY3MERcdTUyQTFcbmNvbnN0IG10U3Vic2NyaXB0aW9uS2V5ID0gXCJDNnczeWRKZ1o1OEh6bUtZQ0tiNHo1RFNvUkN1OUp0T2xmUjhtWTdRMGV5YmNka0xuRjZCSlFRSjk5QkJBQzNwS2FSWEozdzNBQUFiQUNPR1B1c1JcIjtcbmNvbnN0IG10RW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmNvZ25pdGl2ZS5taWNyb3NvZnR0cmFuc2xhdG9yLmNvbS9cIjtcblxuLy8gXHU5MTREXHU3RjZFIEF6dXJlIFx1NjU4N1x1NUI1N1x1OEJDNlx1NTIyQlx1NjcwRFx1NTJBMVxuY29uc3QgdmlzaW9uU3Vic2NyaXB0aW9uS2V5ID0gXCJ0Y0k5NER4d2tTNXE3ZVg5UWpLc2p0V3NVTmd1NjBtOEJqcFRtblZjeDA0blFkYXU3UWRYSlFRSjk5QkJBQzNwS2FSWEozdzNBQUFGQUNPRzJSQzJcIjtcbi8vY29uc3QgdmlzaW9uRW5kcG9pbnQgPSBcImh0dHBzOi8vZWFzdGFzaWEuYXBpLmNvZ25pdGl2ZS5taWNyb3NvZnQuY29tXCI7XG5jb25zdCB2aXNpb25BcGlVcmwgPSBgaHR0cHM6Ly8ke3NlcnZpY2VSZWdpb259LmFwaS5jb2duaXRpdmUubWljcm9zb2Z0LmNvbS92aXNpb24vdjMuMi9vY3JgO1xuXG4vLyBcdTU2RkVcdTcyNDdcdThGNkNcdTY1ODdcdTVCNTdcdTUxRkRcdTY1NzBcbi8vIFx1NEUyRFx1NjU4N1x1OEJDNlx1NTIyQlx1NEUwRFx1NTk3RFx1RkYwQ1x1NzZFRVx1NTI0RFx1NjUzRVx1NUYwM1x1NEY3Rlx1NzUyOFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltYWdlVG9UZXh0KGltYWdlQnVmZmVyOiBBcnJheUJ1ZmZlciwgc3Vic2NyaXB0aW9uS2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgICdPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5Jzogc3Vic2NyaXB0aW9uS2V5LFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ1xuICB9O1xuICBjb25zdCByZXF1ZXN0UGFyYW0gPSB7XG4gICAgdXJsOiB2aXNpb25BcGlVcmwsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczogaGVhZGVycyxcbiAgICBib2R5OiBpbWFnZUJ1ZmZlcixcbiAgfTtcbiAgLy9jb25zb2xlLmxvZyhyZXF1ZXN0UGFyYW0pO1xuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChyZXF1ZXN0UGFyYW0pO1xuXG4gIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XG4gICAgY29uc29sZS5lcnJvcignSW1hZ2UgdG8gdGV4dCBlcnJvcicsIHJlc3BvbnNlKVxuICAgIG5ldyBOb3RpY2UoYEltYWdlIHRvIHRleHQgZXJyb3IgJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcblxuICBjb25zdCByZXN1bHQgPSByZXNwb25zZS5qc29uO1xuICAvLyBcdTYzRDBcdTUzRDZcdThCQzZcdTUyMkJcdTUyMzBcdTc2ODRcdTY1ODdcdTVCNTdcbiAgbGV0IHRvdGFsX3RleHQgPSAnJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQucmVnaW9ucy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHJlZ2lvbiA9IHJlc3VsdC5yZWdpb25zW2ldO1xuICAgIGxldCB0ZXh0ID0gJyc7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCByZWdpb24ubGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSByZWdpb24ubGluZXNbal07XG4gICAgICBmb3IgKGxldCBrID0gMDsgayA8IGxpbmUud29yZHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgY29uc3Qgd29yZCA9IGxpbmUud29yZHNba107XG4gICAgICAgIHRleHQgKz0gd29yZC50ZXh0ICsgJyAnO1xuICAgICAgfVxuICAgICAgdGV4dCArPSAnXFxuJztcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ1x1NTZGRVx1NzI0N1x1OEY2Q1x1NjU4N1x1NUI1N1x1N0VEM1x1Njc5QzonLCB0ZXh0KTtcbiAgICB0b3RhbF90ZXh0ICs9IHRleHQ7XG4gIH1cbiAgcmV0dXJuIHRvdGFsX3RleHQ7XG59XG5cbi8vIFx1NjU4N1x1NjcyQ1x1OEY2Q1x1OEJFRFx1OTdGM1x1NTFGRFx1NjU3MFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGV4dFRvU3BlZWNoSHR0cCh0ZXh0OiBzdHJpbmcsIHN1YnNjcmlwdGlvbktleTogc3RyaW5nLCBzcGVlY2hWb2ljZTogc3RyaW5nKTogUHJvbWlzZTxBcnJheUJ1ZmZlcj4ge1xuICAvLyBcbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAnT2NwLUFwaW0tU3Vic2NyaXB0aW9uLUtleSc6IHN1YnNjcmlwdGlvbktleSxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3NzbWwreG1sJyxcbiAgICAnWC1NaWNyb3NvZnQtT3V0cHV0Rm9ybWF0JzogJ2F1ZGlvLTE2a2h6LTMya2JpdHJhdGUtbW9uby1tcDMnLFxuICAgICdVc2VyLUFnZW50JzogJ015U0RLLzEuMCdcbiAgfTtcbiAgXG4gIGNvbnN0IGJvZHkgPSBgXG4gIDxzcGVhayB2ZXJzaW9uPScxLjAnIHhtbDpsYW5nPSdlbi1VUyc+XG4gICAgICA8dm9pY2UgeG1sOmxhbmc9J2VuLVVTJyB4bWw6Z2VuZGVyPSdGZW1hbGUnIG5hbWU9JyR7c3BlZWNoVm9pY2V9Jz5cbiAgICAgICAgICAke3RleHR9XG4gICAgICA8L3ZvaWNlPlxuICA8L3NwZWFrPlxuICBgO1xuICAvLyBcdTY3ODRcdTVFRkFcdThCRjdcdTZDNDJcdTRGNTNcbiAgY29uc3QgcmVxdWVzdFBhcmFtID0ge1xuICAgICAgdXJsOiBzcGVlY2hBcGlVcmwsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICBib2R5OiBib2R5LFxuICB9O1xuICAvL2NvbnNvbGUubG9nKHJlcXVlc3RQYXJhbSk7XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHJlcXVlc3RQYXJhbSk7XG5cbiAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPSAyMDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RleHQgdG8gc3BlZWNoIGVycm9yJywgcmVzcG9uc2UpXG4gICAgICByZXR1cm4gbmV3IEFycmF5QnVmZmVyKDApO1xuICB9XG4gIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAvLyBcdThGRDRcdTU2REVcdTk3RjNcdTk4OTFcdTY1NzBcdTYzNkVcbiAgcmV0dXJuIHJlc3BvbnNlLmFycmF5QnVmZmVyO1xufVxuXG4vLyBcdTdGRkJcdThCRDFcdTUxRkRcdTY1NzBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0cmFuc2xhdGVUZXh0KHRleHQ6IHN0cmluZywgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZywgc3Vic2NyaXB0aW9uS2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICB0cnkge1xuICAgICAgY29uc3QgYXBpVXJsID0gYCR7bXRFbmRwb2ludH0vdHJhbnNsYXRlP2FwaS12ZXJzaW9uPTMuMCZ0bz0ke3RhcmdldExhbmd1YWdlfWA7XG4gICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAgICdPY3AtQXBpbS1TdWJzY3JpcHRpb24tS2V5Jzogc3Vic2NyaXB0aW9uS2V5LFxuICAgICAgICAgICdPY3AtQXBpbS1TdWJzY3JpcHRpb24tUmVnaW9uJzogc2VydmljZVJlZ2lvbixcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICB9O1xuICAgICAgY29uc3QgYm9keSA9IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAgICd0ZXh0JzogdGV4dFxuICAgICAgICAgIH1cbiAgICAgIF07XG4gICAgICBjb25zdCByZXF1ZXN0UGFyYW0gPSB7XG4gICAgICAgIHVybDogYXBpVXJsLFxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICB9O1xuICAgICAgLy9jb25zb2xlLmxvZyhyZXF1ZXN0UGFyYW0pO1xuICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHJlcXVlc3RQYXJhbSk7XG4gICAgXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdTZW5kIGxsbSByZXF1ZXN0IGVycm9yJywgcmVzcG9uc2UpXG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cbiAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2UuanNvbjtcblxuICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFswXS50cmFuc2xhdGlvbnNbMF0udGV4dDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdcdTY3MkFcdTgzQjdcdTUzRDZcdTUyMzBcdTY3MDlcdTY1NDhcdTc2ODRcdTdGRkJcdThCRDFcdTdFRDNcdTY3OUMnKTtcbiAgICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1N0ZGQlx1OEJEMVx1NTFGQVx1OTUxOTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuIiwgImltcG9ydCB7IHJlcXVlc3RVcmwsIE5vdGljZSwgYXJyYXlCdWZmZXJUb0Jhc2U2NCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEFjY2Vzc1Rva2VuLCBPY3JTZXR0aW5ncyB9IGZyb20gJy4vc2V0dGluZ3MnXG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRva2VuKGFwaUtleTogc3RyaW5nLCBhcGlTZWNyZXQ6IHN0cmluZyk6IFByb21pc2U8QWNjZXNzVG9rZW4+IHtcblx0aWYgKCFhcGlLZXkgfHwgIWFwaVNlY3JldCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEFQSSBrZXkgc2VjcmV0JylcblxuXHRjb25zdCB1cmwgPSBgaHR0cHM6Ly9haXAuYmFpZHViY2UuY29tL29hdXRoLzIuMC90b2tlbj9ncmFudF90eXBlPWNsaWVudF9jcmVkZW50aWFscyZjbGllbnRfaWQ9JHthcGlLZXl9JmNsaWVudF9zZWNyZXQ9JHthcGlTZWNyZXR9YFxuXG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICB9O1xuICBcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICB1cmw6IHVybCxcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICB9KTtcblxuICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ2NyZWF0ZSB0b2tlbiBlcnJvcicsIHJlc3BvbnNlKVxuICAgIHJldHVybiB7fSBhcyBBY2Nlc3NUb2tlbjtcbiAgfVxuXG4gIGNvbnN0IGRhdGEgPSByZXNwb25zZS5qc29uO1xuXHRjb25zdCB0b2tlbiA9IGRhdGEuYWNjZXNzX3Rva2VuXG5cdGNvbnN0IG5vdyA9IERhdGUubm93KClcblx0Y29uc3QgZXhwID0gbm93ICsgZGF0YS5leHBpcmVzX2luXG5cdHJldHVybiB7XG5cdFx0dG9rZW4sXG5cdFx0ZXhwXG5cdH0gYXMgQWNjZXNzVG9rZW5cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQWNjZXNzVG9rZW4ob2NyU2V0dGluZ3M6IE9jclNldHRpbmdzKTogUHJvbWlzZTxib29sZWFuPiB7XG5cdGNvbnN0IG5vdyA9IERhdGUubm93KClcblx0aWYgKFxuICAgIG9jclNldHRpbmdzLmFjY2Vzc1Rva2VuICYmXG5cdFx0b2NyU2V0dGluZ3MuYWNjZXNzVG9rZW4udG9rZW4gJiZcblx0XHRvY3JTZXR0aW5ncy5hY2Nlc3NUb2tlbi5leHAgPiBub3cgKyAzICogNjAgKiAxMDAwXG5cdCkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRjb25zdCBuZXdUb2tlbiA9IGF3YWl0IGNyZWF0ZVRva2VuKG9jclNldHRpbmdzLmFwaUtleSwgb2NyU2V0dGluZ3MuYXBpU2VjcmV0KVxuICBjb25zb2xlLmxvZygnY3JlYXRlIG5ldyB0b2tlbicsIG5ld1Rva2VuKTtcbiAgb2NyU2V0dGluZ3MuYWNjZXNzVG9rZW4gPSBuZXdUb2tlbjtcbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbWFnZVRvVGV4dEh0dHAoaW1hZ2VCdWZmZXI6IEFycmF5QnVmZmVyLCBvY3JTZXR0aW5nczogT2NyU2V0dGluZ3MpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9haXAuYmFpZHViY2UuY29tL3Jlc3QvMi4wL29jci92MS9hY2N1cmF0ZV9iYXNpYz9hY2Nlc3NfdG9rZW49JHtvY3JTZXR0aW5ncy5hY2Nlc3NUb2tlbi50b2tlbn1gXG4gIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICB9O1xuXG4gIGNvbnN0IGltYWdlX2Jhc2U2NCA9IGFycmF5QnVmZmVyVG9CYXNlNjQoaW1hZ2VCdWZmZXIpO1xuICBjb25zdCBib2R5ID0gYGltYWdlPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGltYWdlX2Jhc2U2NCl9JnBhcmFncmFwaD10cnVlYDtcblxuICBjb25zdCByZXF1ZXN0UGFyYW0gPSB7XG4gICAgdXJsOiB1cmwsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczogaGVhZGVycyxcbiAgICBib2R5OiBib2R5LFxuICB9O1xuICAvL2NvbnNvbGUubG9nKHJlcXVlc3RQYXJhbSk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChyZXF1ZXN0UGFyYW0pO1xuXG4gIGlmIChyZXNwb25zZS5zdGF0dXMgIT0gMjAwKSB7XG4gICAgY29uc29sZS5lcnJvcignSW1hZ2UgdG8gdGV4dCBlcnJvcicsIHJlc3BvbnNlKVxuICAgIG5ldyBOb3RpY2UoYEltYWdlIHRvIHRleHQgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIHJldHVybiAnJztcbiAgfVxuICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlKTtcblxuICBjb25zdCByZXN1bHQgPSByZXNwb25zZS5qc29uO1xuICAvLyBcdTYzRDBcdTUzRDZcdThCQzZcdTUyMkJcdTdFRDNcdTY3OUNcdTRFMkRcdTc2ODRcdTY1ODdcdTVCNTdcbiAgbGV0IHRleHQgPSAnJztcbiAgaWYgKHJlc3VsdC5wYXJhZ3JhcGhzX3Jlc3VsdCkge1xuICAgIHJlc3VsdC5wYXJhZ3JhcGhzX3Jlc3VsdC5mb3JFYWNoKChpdGVtOiB7IHdvcmRzX3Jlc3VsdF9pZHg6IG51bWJlcltdIH0pID0+IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbS53b3Jkc19yZXN1bHRfaWR4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRleHQgKz0gcmVzdWx0LndvcmRzX3Jlc3VsdFtpdGVtLndvcmRzX3Jlc3VsdF9pZHhbaV1dLndvcmRzICsgJyAnO1xuICAgICAgfVxuICAgICAgdGV4dCArPSAnXFxuJztcbiAgICB9KTtcbiAgfVxuICBjb25zb2xlLmxvZygnXHU1NkZFXHU3MjQ3XHU4RjZDXHU2NTg3XHU1QjU3XHU2QkI1XHU4NDNEXHU3RUQzXHU2NzlDOicsIHRleHQpO1xuICByZXR1cm4gdGV4dDtcbn1cblxuLyoqXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGV4dFRvU3BlZWNoKHRleHQ6IHN0cmluZywgdGZpbGU6IFRBYnN0cmFjdEZpbGUsIHNldHRpbmdzOiBTdHVkZW50UmVwb1NldHRpbmdzKTogUHJvbWlzZTxBcnJheUJ1ZmZlcj4ge1xuICBjb25zdCBQYXRoTGliID0gcmVxdWlyZSgncGF0aCcpXG4gIGNvbnN0IEFpcFNwZWVjaCA9IHJlcXVpcmUoJ2JhaWR1LWFpcC1zZGsnKS5zcGVlY2g7XG4gIFxuICAvLyBHZW5lcmF0ZSBUVFMgYXVkaW9cbiAgLy8gXHU1MjFCXHU1RUZBXHU0RTAwXHU0RTJBQWlwU3BlZWNoXHU3Njg0XHU1QjlFXHU0RjhCXG4gIGNvbnN0IGNsaWVudCA9IG5ldyBBaXBTcGVlY2goc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBwSUQsIHNldHRpbmdzLm9jclNldHRpbmdzLmFwaUtleSwgc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpU2VjcmV0KTtcbiAgLy8gXHU4QzAzXHU3NTI4dGV4dDJhdWRpb1x1NjVCOVx1NkNENVx1OEZEQlx1ODg0Q1x1NjU4N1x1NjcyQ1x1OEY2Q1x1OEJFRFx1OTdGM1x1NzY4NFx1NTQwOFx1NjIxMFxuICAvLyBcdTUzQzJcdTY1NzBcdTUzMDVcdTYyRUNcdUZGMUFcdTg5ODFcdTU0MDhcdTYyMTBcdTc2ODRcdTY1ODdcdTY3MkNcdTMwMDFcdTU0MDhcdTYyMTBcdTdFRDNcdTY3OUNcdTc2ODRcdTY4M0NcdTVGMEZcdUZGMDhcdTUzRUZcdTkwMDlcdUZGMENcdTlFRDhcdThCQTRcdTY2MkZtcDNcdUZGMDlcdTMwMDFcdTU0MDhcdTYyMTBcdThCRURcdTk3RjNcdTc2ODRcdThCRURcdTkwMUZcdUZGMDhcdTUzRUZcdTkwMDlcdUZGMENcdTUzRDZcdTUwM0NcdTgzMDNcdTU2RjRcdTY2MkYwLTlcdUZGMENcdTlFRDhcdThCQTRcdTY2MkY1XHVGRjA5XHUzMDAxXHU1NDA4XHU2MjEwXHU4QkVEXHU5N0YzXHU3Njg0XHU5N0YzXHU4QzAzXHVGRjA4XHU1M0VGXHU5MDA5XHVGRjBDXHU1M0Q2XHU1MDNDXHU4MzAzXHU1NkY0XHU2NjJGMC05XHVGRjBDXHU5RUQ4XHU4QkE0XHU2NjJGNVx1RkYwOVx1MzAwMVx1NTQwOFx1NjIxMFx1OEJFRFx1OTdGM1x1NzY4NFx1OTdGM1x1OTFDRlx1RkYwOFx1NTNFRlx1OTAwOVx1RkYwQ1x1NTNENlx1NTAzQ1x1ODMwM1x1NTZGNFx1NjYyRjAtOVx1RkYwQ1x1OUVEOFx1OEJBNFx1NjYyRjVcdUZGMDlcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnRleHQyYXVkaW8odGV4dCwge2xhbjogc2V0dGluZ3MudHRzTGFuZ3VhZ2V9KVxuICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAvLyByZXN1bHRcdTY2MkZcdTRFMDBcdTRFMkFcdTUzMDVcdTU0MkJcdThCRURcdTk3RjNcdTRFOENcdThGREJcdTUyMzZcdTY1NzBcdTYzNkVcdTc2ODRCdWZmZXJcdTVCRjlcdThDNjFcbiAgcmV0dXJuIHJlc3VsdC5kYXRhO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJhbnNsYXRlVGV4dCh0ZXh0OiBzdHJpbmcsIHRvX2xhbmc6IHN0cmluZywgc2V0dGluZ3M6IFN0dWRlbnRSZXBvU2V0dGluZ3MpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBBaXBNdCA9IHJlcXVpcmUoJ2JhaWR1LWFpcC1zZGsnKS5tYWNoaW5lVHJhbnNsYXRpb247XG4gIGNvbnN0IGNsaWVudCA9IG5ldyBBaXBNdChzZXR0aW5ncy5vY3JTZXR0aW5ncy5hcHBJRCwgc2V0dGluZ3Mub2NyU2V0dGluZ3MuYXBpS2V5LCBzZXR0aW5ncy5vY3JTZXR0aW5ncy5hcGlTZWNyZXQpO1xuICAvLyBcdThDMDNcdTc1MjhcdTdGRkJcdThCRDFcdTYzQTVcdTUzRTNcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LnRleHR0cmFuc1YxKCdhdXRvJywgdG9fbGFuZywgdGV4dCk7XG4gIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gIGNvbnNvbGUubG9nKHJlc3VsdC5yZXN1bHQudHJhbnNfcmVzdWx0KTtcbiAgbGV0IHJlc3VsdF90ZXh0ID0gJyc7XG4gIHJlc3VsdC5yZXN1bHQudHJhbnNfcmVzdWx0LmZvckVhY2goKGl0ZW06IHsgc3JjOiBzdHJpbmc7IGRzdDogc3RyaW5nIH0pID0+IHtcbiAgICBjb25zb2xlLmxvZygnXHU1MzlGXHU2NTg3XHVGRjFBJywgaXRlbS5zcmMpO1xuICAgIGNvbnNvbGUubG9nKCdcdThCRDFcdTY1ODdcdUZGMUEnLCBpdGVtLmRzdCk7XG4gICAgcmVzdWx0X3RleHQgKz0gaXRlbS5kc3Q7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0X3RleHQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbWFnZVRvVGV4dChmaWxlOiBUQWJzdHJhY3RGaWxlLCBvY3JTZXR0aW5nczogT2NyU2V0dGluZ3MpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBBaXBPY3JDbGllbnQgPSByZXF1aXJlKCdiYWlkdS1haXAtc2RrJykub2NyO1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IG5ldyBBaXBPY3JDbGllbnQob2NyU2V0dGluZ3MuYXBwSUQsIG9jclNldHRpbmdzLmFwaUtleSwgb2NyU2V0dGluZ3MuYXBpU2VjcmV0KTtcbiAgICAvLyBcdThCRkJcdTUzRDZcdTU2RkVcdTcyNDdcdTY1ODdcdTRFRjZcdTVFNzZcdThGNkNcdTYzNjJcdTRFM0EgQmFzZTY0IFx1N0YxNlx1NzgwMVxuICAgIHZhciBpbWFnZV9jb250ZW50ID0gIGF3YWl0IGFwcC52YXVsdC5hZGFwdGVyLnJlYWRCaW5hcnkoZmlsZS5wYXRoKVxuICAgIHZhciBpbWFnZSA9IEJ1ZmZlci5mcm9tKGltYWdlX2NvbnRlbnQpLnRvU3RyaW5nKCdiYXNlNjQnKVxuXG4gICAgLy8gXHU4QzAzXHU3NTI4XHU3NjdFXHU1RUE2XHU0RTkxIE9DUiBcdTc2ODRcdTkwMUFcdTc1MjhcdTY1ODdcdTVCNTdcdThCQzZcdTUyMkJcdTYzQTVcdTUzRTNcbiAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgIG9wdGlvbnNbXCJsYW5ndWFnZV90eXBlXCJdID0gXCJDSE5fRU5HXCI7XG4gICAgb3B0aW9uc1tcInBhcmFncmFwaFwiXSA9IFwidHJ1ZVwiO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2xpZW50LmFjY3VyYXRlQmFzaWMoaW1hZ2UsIG9wdGlvbnMpO1xuICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpO1xuICAgIC8vIFx1NjNEMFx1NTNENlx1OEJDNlx1NTIyQlx1N0VEM1x1Njc5Q1x1NEUyRFx1NzY4NFx1NjU4N1x1NUI1N1xuICAgIGxldCB0ZXh0ID0gJyc7XG4gICAgaWYgKHJlc3VsdC5wYXJhZ3JhcGhzX3Jlc3VsdCkge1xuICAgICAgcmVzdWx0LnBhcmFncmFwaHNfcmVzdWx0LmZvckVhY2goKGl0ZW06IHsgd29yZHNfcmVzdWx0X2lkeDogbnVtYmVyW10gfSkgPT4ge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW0ud29yZHNfcmVzdWx0X2lkeC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRleHQgKz0gcmVzdWx0LndvcmRzX3Jlc3VsdFtpdGVtLndvcmRzX3Jlc3VsdF9pZHhbaV1dLndvcmRzICsgJyAnO1xuICAgICAgICB9XG4gICAgICAgIHRleHQgKz0gJ1xcbic7XG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ1x1NTZGRVx1NzI0N1x1OEY2Q1x1NjU4N1x1NUI1N1x1NkJCNVx1ODQzRFx1N0VEM1x1Njc5QzonLCB0ZXh0KTtcbiAgICByZXR1cm4gdGV4dDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1NTZGRVx1NzI0N1x1OEY2Q1x1NjU4N1x1NUI1N1x1NTFGQVx1OTUxOTonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuKi9cbiIsICJcbmV4cG9ydCBjb25zdCBHRU5FUkFURV9TSU1JTEFSX1RPUElDX1RFTVBMQVRFID0gYFxuXHU0RjYwXHU3Njg0XHU0RUZCXHU1MkExXHU2NjJGXHU2ODM5XHU2MzZFXHU1REYyXHU2NzA5XHU3Njg0XHU5ODk4XHU3NkVFXHU3NTFGXHU2MjEwNVx1OTA1M1x1NjI2OVx1NUM1NVx1OTg5OFx1NzZFRVx1RkYwQ1x1OEZEOVx1NEU5Qlx1OTg5OFx1NzZFRVx1ODk4MVx1N0IyNlx1NTQwOHtHUkFERX1cdTc2ODRcdTc3RTVcdThCQzZcdTZDMzRcdTVFNzNcdTMwMDJcblxuXHU5OTk2XHU1MTQ4XHVGRjBDXHU1REYyXHU2NzA5XHU5ODk4XHU3NkVFXHU1OTgyXHU0RTBCXHVGRjFBXG57VE9QSUN9XG5cbntHUkFERX1cdTc3RTVcdThCQzZcdTZDMzRcdTVFNzNcdTc2ODRcdTUxRkFcdTk4OThcdTg5ODFcdTZDNDJcdTU5ODJcdTRFMEJcdUZGMUFcbjEuIFx1OTg5OFx1NzZFRVx1NEUwRFx1ODBGRFx1OEZDN1x1NEU4RVx1NTkwRFx1Njc0Mlx1RkYwQ1x1ODk4MVx1N0IyNlx1NTQwOHtHUkFERX1cdTVCNjZcdTc1MUZcdTc2ODRcdThCQTRcdTc3RTVcdTgwRkRcdTUyOUJcdTMwMDJcbjIuIFx1NUU5NFx1NkRCNVx1NzZENntHUkFERX1cdThCRkVcdTdBMEJcdTRFMkRcdTc2ODRcdTVFMzhcdTg5QzFcdTc3RTVcdThCQzZcdTcwQjlcdTMwMDJcblxuXHU1NzI4XHU1MUZBXHU5ODk4XHU2NUY2XHVGRjBDXHU4QkY3XHU5MDc1XHU1RkFBXHU0RUU1XHU0RTBCXHU2MzA3XHU1QkZDXHVGRjFBXG4xLiBcdTVCRjlcdTRFOEVcdTZCQ0ZcdTRFMDBcdTkwNTNcdTYyNjlcdTVDNTVcdTk4OThcdTc2RUVcdUZGMENcdTVDM0RcdTkxQ0ZcdTRFQ0VcdTRFMERcdTU0MENcdTc2ODRcdTc3RTVcdThCQzZcdTcwQjlcdTg5RDJcdTVFQTZcdTUxRkFcdTUzRDFcdUZGMENcdTRGNDZcdTg5ODFcdTU3RkFcdTRFOEVcdTUzOUZcdTU5Q0JcdTk4OThcdTc2RUVcdTc2RjhcdTUxNzNcdTc2ODRcdTc3RTVcdThCQzZcdTgzMDNcdTc1NzRcdTMwMDJcbjIuIFx1NTk4Mlx1Njc5Q1x1NTM5Rlx1NTlDQlx1OTg5OFx1NzZFRVx1NjYyRlx1NjU3MFx1NUI2Nlx1OTg5OFx1RkYwQ1x1NjI2OVx1NUM1NVx1OTg5OFx1NzZFRVx1NTNFRlx1NEVFNVx1NjUzOVx1NTNEOFx1NjU3MFx1NUI1N1x1MzAwMVx1OEZEMFx1N0I5N1x1N0IyNlx1NTNGN1x1NjIxNlx1ODAwNVx1OTg5OFx1NTc4Qlx1MzAwMlx1NTk4Mlx1Njc5Q1x1NjYyRlx1OEJFRFx1NjU4N1x1OTg5OFx1RkYwQ1x1NTNFRlx1NEVFNVx1NEVDRVx1NUI1N1x1OEJDRFx1MzAwMVx1OEJFRFx1NTNFNVx1NzQwNlx1ODlFM1x1N0I0OVx1NEUwRFx1NTQwQ1x1NjVCOVx1OTc2Mlx1NTFGQVx1OTg5OFx1MzAwMlxuMy4gXHU3ODZFXHU0RkREXHU5ODk4XHU3NkVFXHU4ODY4XHU4RkYwXHU2RTA1XHU2NjcwXHVGRjBDXHU2Q0ExXHU2NzA5XHU2QjY3XHU0RTQ5XHUzMDAyXG5cblx1OEJGN1x1NjMwOVx1NzE2N1x1NEUwQlx1OTc2Mlx1NzY4NFx1NjgzQ1x1NUYwRlx1N0VEOVx1NTFGQVx1NTZERVx1N0I1NFx1RkYxQVxuXHU2ODM5XHU2MzZFXHU0RTBBXHU4RkYwXHU5ODk4XHU3NkVFXHU3NTFGXHU2MjEwXHU3Njg0XHU2MjY5XHU1QzU1XHU5ODk4XHU3NkVFXHU1OTgyXHU0RTBCXHVGRjFBXG5cdTk4OThcdTc2RUUxXG5cdTk4OThcdTc2RUUyXG4uLi5cbmA7XG5cblxuZXhwb3J0IGNvbnN0IEdFTkVSQVRFX0xFQVJOSU5HX1BPSU5UU19URU1QTEFURSA9IGBcblx1NEY2MFx1NzY4NFx1NEVGQlx1NTJBMVx1NjYyRlx1NjgzOVx1NjM2RVx1N0VEOVx1NUI5QVx1NzY4NFx1OTg5OFx1NzZFRVx1NjAzQlx1N0VEM1x1NzZGOFx1NTE3M1x1NzdFNVx1OEJDNlx1NzBCOVx1MzAwMlx1OEJGN1x1NEVENFx1N0VDNlx1OTYwNVx1OEJGQlx1NEVFNVx1NEUwQlx1OTg5OFx1NzZFRTpcbntUT1BJQ31cblxuXHU1NzI4XHU2MDNCXHU3RUQzXHU3N0U1XHU4QkM2XHU3MEI5XHU2NUY2XHVGRjBDXHU4QkY3XHU2MzA5XHU3MTY3XHU0RUU1XHU0RTBCXHU2QjY1XHU5QUE0XHU4RkRCXHU4ODRDOlxuMS4gXHU0RUQ0XHU3RUM2XHU5NjA1XHU4QkZCXHU5ODk4XHU3NkVFXHU1MTg1XHU1QkI5XHVGRjBDXHU3ODZFXHU1QjlBXHU5ODk4XHU3NkVFXHU2RDg5XHU1M0NBXHU3Njg0XHU0RTNCXHU4OTgxXHU5ODg2XHU1N0RGXHU2MjE2XHU0RTNCXHU5ODk4XHUzMDAyXG4yLiBcdThCQzZcdTUyMkJcdTRFMEVcdTRFM0JcdTk4OThcdTc2RjhcdTUxNzNcdTc2ODRcdTUxNzNcdTk1MkVcdTY5ODJcdTVGRjVcdTMwMDFcdTUzOUZcdTc0MDZcdTYyMTZcdTRGRTFcdTYwNkZcdTMwMDJcbjMuIFx1NUMwNlx1OEZEOVx1NEU5Qlx1Njk4Mlx1NUZGNVx1MzAwMVx1NTM5Rlx1NzQwNlx1NjIxNlx1NEZFMVx1NjA2Rlx1OEZEQlx1ODg0Q1x1NTIwNlx1N0M3Qlx1NjU3NFx1NzQwNlx1MzAwMlxuNC4gXHU1M0JCXHU5NjY0XHU1MTk3XHU0RjU5XHU2MjE2XHU0RTBEXHU5MUNEXHU4OTgxXHU3Njg0XHU0RkUxXHU2MDZGXHUzMDAyXG5cblx1OEJGN1x1NjMwOVx1NzE2N1x1NEUwQlx1OTc2Mlx1NzY4NFx1NjgzQ1x1NUYwRlx1N0VEOVx1NTFGQVx1NTZERVx1N0I1NFx1RkYxQVxuXHU2NzJDXHU5ODk4XHU3NkVFXHU0RTNCXHU4OTgxXHU2RDg5XHU1M0NBXHU1MjMwXHU3Njg0XHU3N0U1XHU4QkM2XHU3MEI5XHU1OTgyXHU0RTBCXHVGRjFBXG5cdTRGNjBcdTc2ODRcdTdCNTRcdTY4NDhcbi4uLlxuYDtcblxuZXhwb3J0IGNvbnN0IEVYUExBSU5fS05PV0xFREdFX1BPSU5UX1RFTVBMQVRFID0gYFxuXHU0RjYwXHU3Njg0XHU0RUZCXHU1MkExXHU2NjJGXHU0RTNBXHU1QjY2XHU3NTFGXHU4OUUzXHU5MUNBXHU2N0QwXHU0RTAwXHU3N0U1XHU4QkM2XHU3MEI5XHUzMDAyXHU4QkY3XHU0RUQ0XHU3RUM2XHU5NjA1XHU4QkZCXHU0RUU1XHU0RTBCXHU3N0U1XHU4QkM2XHU3MEI5XHU1MTg1XHU1QkI5XHVGRjBDXHU1RTc2XHU2MzA5XHU3MTY3XHU2MzA3XHU3OTNBXHU4RkRCXHU4ODRDXHU4OUUzXHU5MUNBXHVGRjFBXG57VE9QSUN9XG5cblx1NTcyOFx1ODlFM1x1OTFDQVx1OEJFNVx1NzdFNVx1OEJDNlx1NzBCOVx1NjVGNlx1RkYwQ1x1OEJGN1x1OTA3NVx1NUZBQVx1NEVFNVx1NEUwQlx1NjMwN1x1NTM1N1x1RkYxQVxuMS4gXHU5OTk2XHU1MTQ4XHU3NTI4XHU5MDFBXHU0RkQ3XHU2NjEzXHU2MUMyXHU3Njg0XHU4QkVEXHU4QTAwXHU1QkY5XHU3N0U1XHU4QkM2XHU3MEI5XHU4RkRCXHU4ODRDXHU1QjlBXHU0RTQ5XHU2MjE2XHU2M0NGXHU4RkYwXHUzMDAyXG4yLiBcdTdFRDlcdTUxRkFcdThCRTVcdTc3RTVcdThCQzZcdTcwQjlcdTc2RjhcdTUxNzNcdTc2ODRcdTc5M0FcdTRGOEJcdUZGMENcdTRFRTVcdTRGQkZcdTY2RjRcdTU5N0RcdTU3MzBcdTc0MDZcdTg5RTNcdTMwMDJcbjMuIFx1OTYxMFx1OEZGMFx1OEJFNVx1NzdFNVx1OEJDNlx1NzBCOVx1NTcyOFx1NUI2Nlx1NEU2MFx1OEZDN1x1N0EwQlx1NEUyRFx1NzY4NFx1OTFDRFx1ODk4MVx1NjAyN1x1NEVFNVx1NTNDQVx1NEUwRVx1NTE3Nlx1NEVENlx1NzdFNVx1OEJDNlx1NzBCOVx1NzY4NFx1ODA1NFx1N0NGQlx1MzAwMlxuNC4gXHU1M0VGXHU4MEZEXHU3Njg0XHU4QkREXHVGRjBDXHU2M0QwXHU1M0NBXHU0RTAwXHU0RTlCXHU1QjY2XHU0RTYwXHU4QkU1XHU3N0U1XHU4QkM2XHU3MEI5XHU3Njg0XHU1RTM4XHU4OUMxXHU2NUI5XHU2Q0Q1XHU2MjE2XHU2MjgwXHU1REU3XHUzMDAyXG41LiBcdTdCNTRcdTY4NDhcdTg5ODFcdTdCODBcdTZEMDFcdTY2MTNcdTYxQzJcdUZGMENcdTRFMERcdTg5ODFcdTUxRkFcdTczQjBcdTZCNjdcdTRFNDlcdTMwMDJcblxuXHU4QkY3XHU2MzA5XHU3MTY3XHU0RTBCXHU5NzYyXHU3Njg0XHU2ODNDXHU1RjBGXHU3RUQ5XHU1MUZBXHU1NkRFXHU3QjU0XHVGRjFBXG57VE9QSUN9XHU3Njg0XHU4OUUzXHU5MUNBXHU1OTgyXHU0RTBCXHVGRjFBXG5cdTRGNjBcdTc2ODRcdTdCNTRcdTY4NDhcbmA7XG5cbiIsICJpbXBvcnQgeyByZXF1ZXN0VXJsIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTExNU2V0dGluZ3MgfSBmcm9tICcuL3NldHRpbmdzJ1xuXG4vLyBcdTcwNkJcdTVDNzFcdTVGMTVcdTY0Q0VcdTU5MjdcdTZBMjFcdTU3OEJcdTkxNERcdTdGNkVcbmNvbnN0IGRvdWJhb1NldHRpbmdzOiBMTE1TZXR0aW5ncyA9IHtcbiAgYXBpQmFzZTogJ2h0dHBzOi8vYXJrLmNuLWJlaWppbmcudm9sY2VzLmNvbS9hcGkvdjMvY2hhdC9jb21wbGV0aW9ucycsXG4gIGFwaUtleTogJzM4M2JjN2ZmLTg5ZWEtNGVlZi04MTE1LWZhOTY2M2QyYWIxNScsXG4gIG1vZGVsTmFtZTogJ2VwLTIwMjQxMTAxMTgxNDM3LXR6aDViJ1xufTtcblxuLy8gXHU1MzQzXHU5NUVFXHU1OTI3XHU2QTIxXHU1NzhCXHU5MTREXHU3RjZFXG5jb25zdCBxd2VuU2V0dGluZ3M6IExMTVNldHRpbmdzID0ge1xuICBhcGlCYXNlOiAnaHR0cHM6Ly9kYXNoc2NvcGUuYWxpeXVuY3MuY29tL2NvbXBhdGlibGUtbW9kZS92MS9jaGF0L2NvbXBsZXRpb25zJyxcbiAgYXBpS2V5OiAnc2stZjdlYWVjNDAzNzliNGQ5YmI1NzZjZGU0ODQ3Njg5ZmMnLFxuICBtb2RlbE5hbWU6ICdxd2VuLXR1cmJvJ1xufTtcblxuLy8gXHU4QzAzXHU3NTI4XHU1OTI3XHU2QTIxXHU1NzhCXHU3Njg0XHU1MUZEXHU2NTcwXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZExMTVJlcXVlc3QocHJvbXB0OiBzdHJpbmcsIGxsbVNldHRpbmdzOiBMTE1TZXR0aW5ncyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IHtcbiAgICAgIFwibW9kZWxcIjogbGxtU2V0dGluZ3MubW9kZWxOYW1lLFxuICAgICAgXCJ0ZW1wcmV0dXJlXCI6IDEsXG4gICAgICBcIm1lc3NhZ2VzXCI6IFtcbiAgICAgICAge1xuICAgICAgICAgIFwicm9sZVwiOiBcInN5c3RlbVwiLFxuICAgICAgICAgIFwiY29udGVudFwiOiBcIlx1NEY2MFx1NjYyRlx1NEUwMFx1NEUyQVx1NUI2Nlx1NzUxRlx1NUI2Nlx1NEU2MFx1NTJBOVx1NzQwNlx1MzAwMlwiXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBcInJvbGVcIjogXCJ1c2VyXCIsXG4gICAgICAgICAgXCJjb250ZW50XCI6IHByb21wdFxuICAgICAgICB9XG4gICAgICBdXG4gICAgfTtcbiAgICBjb25zdCBqc29uQm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuXG4gICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAvLyBcdTRGN0ZcdTc1MjggQVBJIEtleSBcdThGREJcdTg4NENcdTkyNzRcdTY3NDNcbiAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2xsbVNldHRpbmdzLmFwaUtleX1gIFxuICAgIH07XG4gICAgY29uc3QgcmVxdWVzdFBhcmFtID0ge1xuICAgICAgdXJsOiBsbG1TZXR0aW5ncy5hcGlCYXNlLFxuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgYm9keToganNvbkJvZHksXG4gICAgfTtcbiAgICAvL2NvbnNvbGUubG9nKHJlcXVlc3RQYXJhbSk7XG4gIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChyZXF1ZXN0UGFyYW0pO1xuICBcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9IDIwMCkge1xuICAgICAgY29uc29sZS5lcnJvcignU2VuZCBsbG0gcmVxdWVzdCBlcnJvcicsIHJlc3BvbnNlKVxuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICAvL2NvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgXG4gICAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2UuanNvbjtcbiAgICByZXR1cm4gcmVzdWx0LmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1x1OEMwM1x1NzUyOFx1NTkyN1x1NkEyMVx1NTc4Qlx1NTFGQVx1OTUxOTonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4vLyBcdTRGN0ZcdTc1MjhcdTc5M0FcdTRGOEJcbmltcG9ydCB7IEdFTkVSQVRFX1NJTUlMQVJfVE9QSUNfVEVNUExBVEUgfSBmcm9tICcuL3Byb21wdCdcbmFzeW5jIGZ1bmN0aW9uIG1haW4oKSB7XG4gICAgY29uc3QgZ3JhZGUgPSAnXHU1QzBGXHU1QjY2XHU1NkRCXHU1RTc0XHU3RUE3JztcbiAgICBjb25zdCB0b3BpYyA9ICc3ODI4XHU1MUNGXHU1M0JCNTc4XHU2MjQwXHU1Rjk3XHU3Njg0XHU1REVFXHU3Njg0XHU0RTAwXHU1MzRBXHVGRjBDXHU1MThEXHU5NjY0XHU0RUU1MjVcdUZGMENcdTU1NDZcdTY2MkZcdTU5MUFcdTVDMTFcdUZGMUYnO1xuICAgIGNvbnN0IHByb21wdCA9IEdFTkVSQVRFX1NJTUlMQVJfVE9QSUNfVEVNUExBVEUucmVwbGFjZSgne0dSQURFfScsIGdyYWRlKS5yZXBsYWNlKCd7VE9QSUN9JywgdG9waWMpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNlbmRMTE1SZXF1ZXN0KHByb21wdCwgcXdlblNldHRpbmdzKTtcbiAgICAgICAgY29uc29sZS5sb2coJ1x1NTkyN1x1NkEyMVx1NTc4Qlx1NTRDRFx1NUU5NDonLCByZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1NTFGQVx1NzNCMFx1OTUxOVx1OEJFRjonLCBlcnJvcik7XG4gICAgfVxufVxuXG5tYWluKCk7XG4qL1xuIiwgIlxuY29uc3QgcGx1Z2luTmFtZSA9IFwiU3R1ZGVudCBSZXBvXCI7XG5jb25zdCBzaW1pbGFyVG9waWNzID0gXCJTaW1pbGFyIFRvcGljc1wiO1xuY29uc3QgbGVhcm5pbmdQb2ludHMgPSBcIkxlYXJuaW5nIFBvaW50c1wiO1xuY29uc3QgaW1hZ2VUb1RleHQgPSBcIkltYWdlIHRvIFRleHRcIjtcbmNvbnN0IHRleHRUb1NwZWVjaCA9IFwiVGV4dCB0byBTcGVlY2hcIjtcbmNvbnN0IHRyYW5zbGF0ZVRleHQgPSBcIlRyYW5zbGF0ZVwiO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIHBsdWdpbk5hbWU6IGAke3BsdWdpbk5hbWV9YCxcbiAgc2ltaWxhclRvcGljczogYCR7c2ltaWxhclRvcGljc31gLFxuICBsZWFybmluZ1BvaW50czogYCR7bGVhcm5pbmdQb2ludHN9YCxcbiAgaW1hZ2VUb1RleHQ6IGAke2ltYWdlVG9UZXh0fWAsXG4gIHRleHRUb1NwZWVjaDogYCR7dGV4dFRvU3BlZWNofWAsXG4gIHRyYW5zbGF0ZVRleHQ6IGAke3RyYW5zbGF0ZVRleHR9YCxcbiAgaW1hZ2VUb1RleHRNZW51OiBgJHtwbHVnaW5OYW1lfTogJHtpbWFnZVRvVGV4dH1gLFxuICB0ZXh0VG9TcGVlY2hNZW51OiBgJHtwbHVnaW5OYW1lfTogJHt0ZXh0VG9TcGVlY2h9YCxcbiAgdHJhbnNsYXRlVGV4dE1lbnU6IGAke3BsdWdpbk5hbWV9OiAke3RyYW5zbGF0ZVRleHR9YCxcbiAgZ2VuU2ltaWxhclRvcGljc01lbnU6IGAke3BsdWdpbk5hbWV9OiAke3NpbWlsYXJUb3BpY3N9YCxcbiAgZ2VuTGVhcm5pbmdQb2ludHNNZW51OiBgJHtwbHVnaW5OYW1lfTogJHtsZWFybmluZ1BvaW50c31gLFxuICBjcmVhdGVOb2RlRnJvbUltYWdlc01lbnU6IGAke3BsdWdpbk5hbWV9OiBDcmVhdGUgbm90ZSBmcm9tIGltYWdlc2AsXG4gIGNyZWF0ZU5vZGVGcm9tSW1hZ2VNZW51OiBgJHtwbHVnaW5OYW1lfTogQ3JlYXRlIG5vdGUgZnJvbSBpbWFnZWAsXG4gIGFuYWx5c2lzQW5kU3VtbWFyaXplOiBgQW5hbHl6ZSAmIFN1bW1hcml6ZWAsXG4gIC8vIEZvciBzZXR0aW5nc1xuICBsbG1Qcm92aWRlcjogXCJBbGliYWJhIFF3ZW5cIixcbiAgb2NyUHJvdmlkZXI6IFwiQmFpZHUgQ2xvdWRcIixcbiAgdHRzUHJvdmlkZXI6IFwiTWljcm9zb2Z0IEF6dXJlXCIsXG4gIHN0dWRlbnRHcmFkZTogYFN0dWRlbnQgR3JhZGVgLFxuICBsbG1TZXR0aW5nOiBgTExNIFNldHRpbmdzYCxcbiAgc3BlZWNoU2V0dGluZzogJ1NwZWVjaCBhbmQgVHJhbnNsYXRpb24nLFxuICBzcGVlY2hTdWJzY3JpcHRpb25LZXk6ICdTcGVlY2ggU3Vic2NyaXB0aW9uIEtleScsXG4gIHNwZWVjaFZvaWNlVHlwZTogJ1NwZWVjaCBWb2ljZSBUeXBlJyxcbiAgc3BlZWNoVm9pY2VHQjogJ0dyZWF0IEJyaXRhaW4nLFxuICBzcGVlY2hWb2ljZVVTOiAnVVNBJyxcbiAgbXRTdWJzY3JpcHRpb25LZXk6ICdUcmFuc2xhdGlvbiBTdWJzY3JpcHRpb24gS2V5Jyxcbn07XG4iLCAiY29uc3QgcGx1Z2luTmFtZSA9IFwiXHU1QjY2XHU3NTFGXHU3N0U1XHU4QkM2XHU1RTkzXCI7XG5jb25zdCBzaW1pbGFyVG9waWNzID0gXCJcdTk4OThcdTc2RUVcdTYyNjlcdTVDNTVcIjtcbmNvbnN0IGxlYXJuaW5nUG9pbnRzID0gXCJcdTc3RTVcdThCQzZcdTcwQjlcdTUyMDZcdTY3OTBcIjtcbmNvbnN0IGltYWdlVG9UZXh0ID0gXCJcdTY1ODdcdTVCNTdcdThCQzZcdTUyMkJcIjtcbmNvbnN0IHRleHRUb1NwZWVjaCA9IFwiXHU2NTg3XHU1QjU3XHU4RjZDXHU4QkVEXHU5N0YzXCI7XG5jb25zdCB0cmFuc2xhdGVUZXh0ID0gXCJcdTdGRkJcdThCRDFcIjtcblxuZXhwb3J0IGRlZmF1bHQge1xuICBwbHVnaW5OYW1lOiBgJHtwbHVnaW5OYW1lfWAsXG4gIHNpbWlsYXJUb3BpY3M6IGAke3NpbWlsYXJUb3BpY3N9YCxcbiAgbGVhcm5pbmdQb2ludHM6IGAke2xlYXJuaW5nUG9pbnRzfWAsXG4gIGltYWdlVG9UZXh0OiBgJHtpbWFnZVRvVGV4dH1gLFxuICB0ZXh0VG9TcGVlY2g6IGAke3RleHRUb1NwZWVjaH1gLFxuICB0cmFuc2xhdGVUZXh0OiBgJHt0cmFuc2xhdGVUZXh0fWAsXG4gIGltYWdlVG9UZXh0TWVudTogYCR7cGx1Z2luTmFtZX06ICR7aW1hZ2VUb1RleHR9YCxcbiAgdGV4dFRvU3BlZWNoTWVudTogYCR7cGx1Z2luTmFtZX06ICR7dGV4dFRvU3BlZWNofWAsXG4gIHRyYW5zbGF0ZVRleHRNZW51OiBgJHtwbHVnaW5OYW1lfTogJHt0cmFuc2xhdGVUZXh0fWAsXG4gIGdlblNpbWlsYXJUb3BpY3NNZW51OiBgJHtwbHVnaW5OYW1lfTogJHtzaW1pbGFyVG9waWNzfWAsXG4gIGdlbkxlYXJuaW5nUG9pbnRzTWVudTogYCR7cGx1Z2luTmFtZX06ICR7bGVhcm5pbmdQb2ludHN9YCxcbiAgY3JlYXRlTm9kZUZyb21JbWFnZXNNZW51OiBgJHtwbHVnaW5OYW1lfTogXHU0RUNFXHU1NkZFXHU3MjQ3XHU3NTFGXHU2MjEwXHU3QjE0XHU4QkIwYCxcbiAgY3JlYXRlTm9kZUZyb21JbWFnZU1lbnU6IGAke3BsdWdpbk5hbWV9OiBcdTRFQ0VcdTU2RkVcdTcyNDdcdTc1MUZcdTYyMTBcdTdCMTRcdThCQjBgLFxuICBhbmFseXNpc0FuZFN1bW1hcml6ZTogYFx1NTIwNlx1Njc5MCZcdTYyNjlcdTVDNTVgLFxuICAvLyBGb3Igc2V0dGluZ3NcbiAgbGxtUHJvdmlkZXI6IFwiXHU5NjNGXHU5MUNDXHU1MzQzXHU5NUVFXCIsXG4gIG9jclByb3ZpZGVyOiBcIlx1NzY3RVx1NUVBNlx1NEU5MVwiLFxuICB0dHNQcm92aWRlcjogXCJcdTVGQUVcdThGNkZBenVyZVwiLFxuICBzdHVkZW50R3JhZGU6IGBcdTVCNjZcdTc1MUZcdTVFNzRcdTdFQTdgLFxuICBsbG1TZXR0aW5nOiBgXHU1OTI3XHU2QTIxXHU1NzhCXHU5MTREXHU3RjZFYCxcbiAgc3BlZWNoU2V0dGluZzogJ1x1OEJFRFx1OTdGM1x1NTQwOFx1NjIxMFx1NEUwRVx1N0ZGQlx1OEJEMScsXG4gIHNwZWVjaFN1YnNjcmlwdGlvbktleTogJ1x1OEJFRFx1OTdGM1x1NjcwRFx1NTJBMUtleScsXG4gIHNwZWVjaFZvaWNlVHlwZTogJ1x1OEJFRFx1OTdGM1x1OThDRVx1NjgzQycsXG4gIHNwZWVjaFZvaWNlR0I6ICdcdTgyRjFcdTVGMEYnLFxuICBzcGVlY2hWb2ljZVVTOiAnXHU3RjhFXHU1RjBGJyxcbiAgbXRTdWJzY3JpcHRpb25LZXk6ICdcdTdG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c0IsR0FBRyxRQUFRLE1BQU0sR0FBRztBQUMvRDtBQUFBLE1BQ0Y7QUFDQSxjQUFRLElBQUk7QUFBQSxJQUNkO0FBR0EsVUFBTSxJQUFJLE1BQU0sT0FBTyxHQUFHLFdBQVcsUUFBUTtBQUM3QyxVQUFNLElBQUksVUFBVSxhQUFhLE1BQU0sRUFBRTtBQUFBLEVBQzNDLFNBQVMsR0FBUDtBQUNBLFFBQUksd0JBQU8sMkNBQTRDLEVBQVUsT0FBTztBQUN4RSxVQUFNO0FBQUEsRUFDUjtBQUNGO0FBRUEsZUFBZSxpQkFBaUIsT0FBZ0I7QUFDOUMsTUFBSTtBQUNKLE1BQUksYUFBc0IsSUFBSSxNQUFNLE1BQU0sTUFBTTtBQUNoRCxPQUFLLEtBQUssT0FBTztBQUNmLFlBQVEsSUFBSSxVQUFVLE1BQU0sQ0FBQyxFQUFFLE9BQU8sZ0JBQWdCLE1BQU0sQ0FBQyxFQUFFLE9BQU8sTUFBTTtBQUM1RSxlQUFXLENBQUMsSUFBSSxNQUFNLENBQUMsRUFBRTtBQUFBLEVBQzNCO0FBQ0EsYUFBVyxLQUFLO0FBQ2hCLE1BQUksV0FBa0I7QUFDdEIsT0FBSyxLQUFLLFlBQVk7QUFDcEIsWUFBUSxJQUFJLFdBQVcsQ0FBQyxDQUFDO0FBQ3pCLGdCQUFZLE1BQU0sV0FBVyxDQUFDO0FBQUE7QUFBQSxFQUNoQztBQUNBLFVBQVEsSUFBSSxRQUFRO0FBRXBCLFFBQU0sV0FBVyxZQUFZLFFBQVE7QUFDdkM7QUFFQSxTQUFTLGVBQWUsTUFBYyxNQUFzQjtBQUMxRCxTQUFPO0FBQUEsWUFBZTtBQUFBLElBQVcsS0FBSyxNQUFNLElBQUksRUFBRSxJQUFJLFVBQVEsS0FBSyxNQUFNLEVBQUUsS0FBSyxJQUFJO0FBQ3RGOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiYXBwIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInRyYW5zbGF0ZVRleHQiLCAicGx1Z2luTmFtZSIsICJzaW1pbGFyVG9waWNzIiwgImxlYXJuaW5nUG9pbnRzIiwgImltYWdlVG9UZXh0IiwgInRleHRUb1NwZWVjaCIsICJ0cmFuc2xhdGVUZXh0Il0KfQo=
